(self.webpackJsonp=self.webpackJsonp||[]).push([[31],{385:function(e,t,n){"use strict";var o=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,u,a,l,f,d,p,v,h,b,y,m,w,_,g,k,x,O,j,q,C=[].indexOf;n(4),u=n(1),h=n(2),n(82),q=n(3),x=n(83),n(5);var P=n(34);P.make_field_input,P.make_field_select,n(34).form_group_input_div;var V=n(21);j=V.modal_close_button,v=u.Radio.channel("global"),b=u.Radio.channel("messages"),s=u.Radio.channel("ebcsv"),a=v.request("main:app:BaseModalView"),k=new u.Collection,s.reply("get-csvrow-collection",function(){return k}),O=function(){var e,t,n;for(t in n=[],e=s.request("get-csv-header"))n.push(e[t]);return""+n.join(",")},g=function(){var e,t,n,o,r,i,c,u,a,l;for(e=s.request("get-csvrow-collection"),s.request("get-csv-header"),c=[O()],o=0,r=(u=e.models).length;o<r;o++){for(n in l=[],t=u[o].toJSON())a=(a=t[n]).split('"').join('""'),0<=C.call(a," ")&&(a='"'+a+'"'),l.push(a);i=l.join(","),c.push(i)}return c.join("\r\n")+"\r\n"},y=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,a),t}();return e.prototype.template=q.renderable(function(e){return e.mainsection,q.div(".modal-dialog",function(){return q.div(".modal-content",function(){return q.h4("Title: "+e.Title),q.div(".modal-body",function(){return q.h4("Description:"),q.hr(),q.div(".panel",function(){return q.raw(e.Description)})}),q.div(".modal-footer",function(){return q.ul(".list-inline",function(){return"btn.btn-default.btn-sm",q.li("#close-modal",function(){return j("Close","check")})})})})})}),e}.call(void 0),m=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,a),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).csvheader=s.request("get-csv-header"),e}}]),t}();return e.prototype.template=q.renderable(function(t){return q.div(".modal-dialog",function(){return q.div(".modal-content",function(){return q.h3("Title: "+t.Title),q.div(".modal-body",function(){return q.h4("CSV Row:"),q.hr(),q.div(".panel",function(){return q.dl(".dl-horizontal",function(){return Object.keys(t).forEach(function(e){return q.dt(t.csvheader[e]),q.dd(t[e])})})})}),q.div(".modal-footer",function(){return q.ul(".list-inline",function(){return q.li("#close-modal",function(){return j("Close","check")})})})})})}),e}.call(void 0),_=["max-width:0","overflow:hidden","text-overflow:ellipsis","white-space:nowrap"].join(";")+";",p=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,h.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).csvheader=s.request("get-csv-header"),e}},{key:"show_row",value:function(){var e;return e=new m({model:this.model}),v.request("show-modal",e)}},{key:"show_description",value:function(){var e;return e=new y({model:this.model}),v.request("show-modal",e)}}]),t}();return e.prototype.tagName="tr",e.prototype.template=q.renderable(function(t){return q.td(function(){return q.div(".btn-group.btn-group-justified",function(){return q.div(".show-desc-button.btn.btn-default.btn-xs",function(){return q.i(".fa.fa-eye")}),q.div(".show-row-button.btn.btn-default.btn-xs",function(){return q.i(".fa.fa-list")})})}),Object.keys(t.csvheader).forEach(function(e){return q.td({style:_},t[e])})}),e.prototype.ui={desc_btn:".show-desc-button",row_btn:".show-row-button"},e.prototype.events={"click @ui.desc_btn":"show_description","click @ui.row_btn":"show_row"},e}.call(void 0),d=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,h.CollectionView),t}();return e.prototype.tagName="tbody",e.prototype.childView=p,e}.call(void 0),w=["table","table-striped","table-bordered","table-hover","table-condensed"],f=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,h.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).ebcfg_collection=s.request("ebcfg-collection"),e.ebdsc_collection=s.request("ebdsc-collection"),e.csvheader=s.request("get-csv-header"),e}},{key:"onRender",value:function(){var e,t;return e=s.request("get-csvrow-collection"),t=new d({collection:e}),this.showChildView("body",t)}}]),t}();return e.prototype.tagName="table",e.prototype.className=w.join(" "),e.prototype.template=q.renderable(function(t){return q.div(".table-responsive",function(){return q.table("."+w.join("."),function(){return q.thead(function(){return q.tr(".info",function(){return q.td(function(){return q.i(".fa.fa-eye.fa-3x")}),Object.keys(t.csvheader).forEach(function(e){return q.th(t.csvheader[e])})})}),q.tbody()})})}),e.prototype.regions={body:{el:"tbody",replaceElement:!0}},e}.call(void 0),l=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,h.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).ebcfg_collection=s.request("ebcfg-collection"),e.ebdsc_collection=s.request("ebdsc-collection"),e}},{key:"open_fileexchange_tab",value:function(){return window.open("http://bulksell.ebay.com/ws/eBayISAPI.dll?FileExchangeUploadForm","_blank")}},{key:"make_csv_file",value:function(){var e,t,n,o;return g(),t=new Date,o=x(t,"yyyy-mm-dd-HH:MM:ss"),e=this.ui.filename_input.val()||"export-"+o+".csv",n={type:"data:text/csv;charset=utf-8",data:g(),el_id:"exported-csv-anchor",filename:e},v.request("export-to-file",n)}},{key:"createCsvRows",value:function(){var e,t,n,o,r,i,c,u,a;for(e=s.request("get-current-csv-action"),n=s.request("get-current-csv-cfg"),o=s.request("get-current-csv-dsc"),a=[],r=0,i=(u=this.collection.toJSON()).length;r<i;r++)c={action:e,comic:u[r],cfg:n,desc:o},t=s.request("create-csv-row-object",c),a.push(t);return s.request("get-csvrow-collection").set(a)}},{key:"onRender",value:function(){var e,t,n;return t=s.request("get-comic-image-urls"),Object.keys(t).length||("No pictures attached, please view comics, then create csv",b.request("warning","No pictures attached, please view comics, then create csv")),this.createCsvRows(),e=s.request("get-csvrow-collection"),n=new f({collection:e}),this.showChildView("body",n)}}]),t}();return e.prototype.regions={body:".body"},e.prototype.template=q.renderable(function(e){var t,n;return n=new Date,t="export-"+x(n,"mmddHHMM")+".csv",q.div(".listview-header",function(){return q.text("Preview CSV")}),q.div(".fileexchange-button.btn.btn-default","Ebay Upload"),q.div(".mkcsv-button.btn.btn-default","Create CSV"),q.input(".form-control",{value:t,name:"csvfilename"}),q.div(".body")}),e.prototype.ui={mkcsv_btn:".mkcsv-button",filename_input:"input[name='csvfilename']",fileexchange_btn:".fileexchange-button"},e.prototype.events={"click @ui.mkcsv_btn":"make_csv_file","click @ui.fileexchange_btn":"open_fileexchange_tab"},e}.call(void 0),e.exports=l}}]);
//# sourceMappingURL=ebcsv-view-csvpreview-view-helper-422d62c4e90061316e2b.js.map