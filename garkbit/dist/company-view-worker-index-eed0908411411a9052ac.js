(self.webpackJsonp=self.webpackJsonp||[]).push([[33],{464:function(e,t,n){var o={"./af":313,"./af.js":313,"./ar":314,"./ar-dz":315,"./ar-dz.js":315,"./ar-kw":316,"./ar-kw.js":316,"./ar-ly":317,"./ar-ly.js":317,"./ar-ma":318,"./ar-ma.js":318,"./ar-sa":319,"./ar-sa.js":319,"./ar-tn":320,"./ar-tn.js":320,"./ar.js":314,"./az":321,"./az.js":321,"./be":322,"./be.js":322,"./bg":323,"./bg.js":323,"./bm":324,"./bm.js":324,"./bn":325,"./bn-bd":326,"./bn-bd.js":326,"./bn.js":325,"./bo":327,"./bo.js":327,"./br":328,"./br.js":328,"./bs":329,"./bs.js":329,"./ca":330,"./ca.js":330,"./cs":331,"./cs.js":331,"./cv":332,"./cv.js":332,"./cy":333,"./cy.js":333,"./da":334,"./da.js":334,"./de":335,"./de-at":336,"./de-at.js":336,"./de-ch":337,"./de-ch.js":337,"./de.js":335,"./dv":338,"./dv.js":338,"./el":339,"./el.js":339,"./en-au":340,"./en-au.js":340,"./en-ca":341,"./en-ca.js":341,"./en-gb":342,"./en-gb.js":342,"./en-ie":343,"./en-ie.js":343,"./en-il":344,"./en-il.js":344,"./en-in":345,"./en-in.js":345,"./en-nz":346,"./en-nz.js":346,"./en-sg":347,"./en-sg.js":347,"./eo":348,"./eo.js":348,"./es":349,"./es-do":350,"./es-do.js":350,"./es-mx":351,"./es-mx.js":351,"./es-us":352,"./es-us.js":352,"./es.js":349,"./et":353,"./et.js":353,"./eu":354,"./eu.js":354,"./fa":355,"./fa.js":355,"./fi":356,"./fi.js":356,"./fil":357,"./fil.js":357,"./fo":358,"./fo.js":358,"./fr":359,"./fr-ca":360,"./fr-ca.js":360,"./fr-ch":361,"./fr-ch.js":361,"./fr.js":359,"./fy":362,"./fy.js":362,"./ga":363,"./ga.js":363,"./gd":364,"./gd.js":364,"./gl":365,"./gl.js":365,"./gom-deva":366,"./gom-deva.js":366,"./gom-latn":367,"./gom-latn.js":367,"./gu":368,"./gu.js":368,"./he":369,"./he.js":369,"./hi":370,"./hi.js":370,"./hr":371,"./hr.js":371,"./hu":372,"./hu.js":372,"./hy-am":373,"./hy-am.js":373,"./id":374,"./id.js":374,"./is":375,"./is.js":375,"./it":376,"./it-ch":377,"./it-ch.js":377,"./it.js":376,"./ja":378,"./ja.js":378,"./jv":379,"./jv.js":379,"./ka":380,"./ka.js":380,"./kk":381,"./kk.js":381,"./km":382,"./km.js":382,"./kn":383,"./kn.js":383,"./ko":384,"./ko.js":384,"./ku":385,"./ku.js":385,"./ky":386,"./ky.js":386,"./lb":387,"./lb.js":387,"./lo":388,"./lo.js":388,"./lt":389,"./lt.js":389,"./lv":390,"./lv.js":390,"./me":391,"./me.js":391,"./mi":392,"./mi.js":392,"./mk":393,"./mk.js":393,"./ml":394,"./ml.js":394,"./mn":395,"./mn.js":395,"./mr":396,"./mr.js":396,"./ms":397,"./ms-my":398,"./ms-my.js":398,"./ms.js":397,"./mt":399,"./mt.js":399,"./my":400,"./my.js":400,"./nb":401,"./nb.js":401,"./ne":402,"./ne.js":402,"./nl":403,"./nl-be":404,"./nl-be.js":404,"./nl.js":403,"./nn":405,"./nn.js":405,"./oc-lnc":406,"./oc-lnc.js":406,"./pa-in":407,"./pa-in.js":407,"./pl":408,"./pl.js":408,"./pt":409,"./pt-br":410,"./pt-br.js":410,"./pt.js":409,"./ro":411,"./ro.js":411,"./ru":412,"./ru.js":412,"./sd":413,"./sd.js":413,"./se":414,"./se.js":414,"./si":415,"./si.js":415,"./sk":416,"./sk.js":416,"./sl":417,"./sl.js":417,"./sq":418,"./sq.js":418,"./sr":419,"./sr-cyrl":420,"./sr-cyrl.js":420,"./sr.js":419,"./ss":421,"./ss.js":421,"./sv":422,"./sv.js":422,"./sw":423,"./sw.js":423,"./ta":424,"./ta.js":424,"./te":425,"./te.js":425,"./tet":426,"./tet.js":426,"./tg":427,"./tg.js":427,"./th":428,"./th.js":428,"./tk":429,"./tk.js":429,"./tl-ph":430,"./tl-ph.js":430,"./tlh":431,"./tlh.js":431,"./tr":432,"./tr.js":432,"./tzl":433,"./tzl.js":433,"./tzm":434,"./tzm-latn":435,"./tzm-latn.js":435,"./tzm.js":434,"./ug-cn":436,"./ug-cn.js":436,"./uk":437,"./uk.js":437,"./ur":438,"./ur.js":438,"./uz":439,"./uz-latn":440,"./uz-latn.js":440,"./uz.js":439,"./vi":441,"./vi.js":441,"./x-pseudo":442,"./x-pseudo.js":442,"./yo":443,"./yo.js":443,"./zh-cn":444,"./zh-cn.js":444,"./zh-hk":445,"./zh-hk.js":445,"./zh-mo":446,"./zh-mo.js":446,"./zh-tw":447,"./zh-tw.js":447};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=s,e.exports=r,r.id=464},466:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;return t=e.fetchData||{},console.log("fetchData",t),function(e,n,o){var r,a,l;return console.log("fetchInfo",e),a=new s,r=(0,d.extend)(t,{start:e.startStr,end:e.endStr,limit:9999}),console.log("DATA",r),l=a.fetch({data:r}),console.log("response",l),l.done((function(){var e,t;return t=a.toJSON(),console.log("returned these events",t),console.log("events",a),e=[],a.forEach((function(t){var n,o,r;return r=h.DateTime.fromISO(t.get("start"),{zone:"UTC"}),n=h.DateTime.fromISO(t.get("end"),{zone:"UTC"}),o={start:r.toLocal().toString(),end:n.toLocal().toString(),id:t.id,url:"#company/session/view/"+t.id,backgroundColor:u(t.get("worker_id"))},e.push(o)})),console.log("calendarEvents",e),n(e)})),l.fail((function(){return o(l),i.request("xhr-error",l)}))}};var o,r,s,a,i,u,l,c,f=n(1),d=n(0),h=n(497),p=n(467),j=(o=p)&&o.__esModule?o:{default:o};a=f.Radio.channel("global"),i=f.Radio.channel("messages"),r=a.request("main:app:AuthCollection"),s=function(){var e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r);return e.prototype.url="/api/dev/company/calendar",e}.call(void 0),l=["green","chocolate","blue","magenta"],c={},u=function(e){var t,n;return c[e]?c[e]:(t=(0,j.default)(l),(n=l.indexOf(t))>-1&&l.splice(n,1),c[e]=t,c[e])}},710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),s=n(4),a=m(n(7)),i=m(n(295));n(712),n(713);var u,l,c,f,d,h,p=m(n(715)),j=m(n(720)),b=m(n(466));function m(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}u=r.Radio.channel("company"),h=u.request("TimeClock"),c=function(){var e=function(e){function t(){return v(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return k(t,e),t}(s.View);return e.prototype.template=a.default.renderable((function(){return a.default.div(".row.listview-list-entry",(function(){return a.default.text("You are not a worker.")}))})),e}.call(void 0),f=function(){var e=function(e){function t(){return v(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return k(t,e),o(t,[{key:"onSomething",value:function(){var e;e=this.model.get("id"),new h({worker_id:e})}}]),t}(s.View);return e.prototype.template=a.default.renderable((function(e){return a.default.div((function(){var t,n,o,r;return n=e.session,r=e.worker.status,n?"off"===r&&n.end?(t=i.default.utc(n.end),a.default.text("Your last session ended "+t.fromNow())):"on"===r?(o=i.default.utc(n.start),a.default.text("You have been working since "+o.fromNow())):void 0:a.default.text("You have never clocked in.")}))})),e}.call(void 0),d=function(){var e=function(e){function t(){return v(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return k(t,e),o(t,[{key:"ui",value:function(){return{monthBtn:".month-btn",weekBtn:".week-btn",dayBtn:".day-btn",workSessionRegion:".work-session",calendarRegion:".calendar",clockBtnRegion:".clock-btn-container",datePick:".datepick"}}},{key:"events",value:function(){return{"click @ui.monthBtn":"monthBtnClicked","click @ui.weekBtn":"weekBtnClicked","click @ui.dayBtn":"dayBtnClicked"}}},{key:"onRender",value:function(){var e,t,n=this;return(e=new h).fetch().done((function(){var t;return console.log("clock is",e),t=new f({model:e}),n.showChildView("workSessionRegion",t)})),t=new j.default({model:this.model}),this.showChildView("clockBtnRegion",t)}},{key:"onDomRefreshOrig",value:function(){return this.ui.datePick.daterangepicker({timePicker:!0,locale:{format:"M/DD hh:mm A"}})}},{key:"monthBtnClicked",value:function(){return this.showCalendar({className:"col-md-8 offset-md-2",calendarOptions:{defaultDate:new Date,header:{left:"prevYear, nextYear",center:"title",right:"prev, next"},events:(0,b.default)({fetchData:this.getOption("fetchData")||{}})}})}},{key:"weekBtnClicked",value:function(){return this.showCalendar({className:"col-md-8 offset-md-2",calendarOptions:{defaultDate:new Date,defaultView:"timeGridWeek",header:{left:"prevYear, nextYear",center:"title",right:"prev, next"},events:(0,b.default)({fetchData:this.getOption("fetchData")||{}})}})}},{key:"dayBtnClicked",value:function(){return this.showCalendar({className:"col-md-8 offset-md-2",calendarOptions:{defaultDate:new Date,defaultView:"timeGridDay",header:{left:"prevYear, nextYear",center:"title",right:"prev, next"},events:(0,b.default)({fetchData:this.getOption("fetchData")||{}})}})}},{key:"showCalendar",value:function(e){var t;return t=new p.default(e),this.showChildView("calendarRegion",t)}}]),t}(s.View);return e.prototype.template=a.default.renderable((function(e){var t;return t={action:"in",btnClass:".clock-btn.btn.btn-info.fa.fa-clock-o"},"on"===e.status&&(t.action="out",t.btnClass=".clock-btn.btn.btn-warning.fa.fa-clock-o"),a.default.div(".row",(function(){return a.default.div(".col.work-session")})),a.default.div(".btn-group",(function(){return a.default.div(".clock-btn-container"),a.default.button(".month-btn.btn.btn-success.fa.fa-calendar","Month"),a.default.button(".week-btn.btn.btn-success.fa.fa-calendar","Week"),a.default.button(".day-btn.btn.btn-success.fa.fa-calendar","Day")})),a.default.div(".row.calendar"),a.default.input(".datepick")})),e.prototype.regions={workSessionRegion:"@ui.workSessionRegion",calendarRegion:"@ui.calendarRegion",clockBtnRegion:"@ui.clockBtnRegion"},e.prototype.childViewEvents={"worker:status:change":"render"},e}.call(void 0),l=function(){var e=function(e){function t(){return v(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return k(t,e),o(t,[{key:"ui",value:function(){return{status:".status"}}},{key:"onRender",value:function(){var e,t=this;return(e=this.model.fetch()).done((function(){var e;return e=new d({model:t.model}),t.showChildView("status",e)})),e.fail((function(){var e;return e=new c({model:t.model}),t.showChildView("status",e)}))}}]),t}(s.View);return e.prototype.template=a.default.renderable((function(){return a.default.div(".row.status")})),e.prototype.regions={status:"@ui.status"},e}.call(void 0),t.default=l},720:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,s,a,i,u,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(1),f=n(4),d=n(7),h=(o=d)&&o.__esModule?o:{default:o};a=c.Radio.channel("messages"),r=c.Radio.channel("company"),i=r.request("TimeClock"),u={on:"out",off:"in"},s=function(){var e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),l(t,[{key:"templateContext",value:function(){}},{key:"onRender",value:function(){return"on"===this.model.get("status")?(this.$el.removeClass("btn-info"),this.$el.addClass("btn-warning")):(this.$el.removeClass("btn-warning"),this.$el.addClass("btn-info"))}},{key:"punchClock",value:function(){var e;return"off"===(e=this.model.get("status"))||null===e?this.punchIn():"on"===e?this.punchOut():a.request("danger","Bad worker status "+e)}},{key:"punchIn",value:function(){var e,t,n=this;return e=new i,(t=e.save(null,{type:"POST",url:e.urlRoot})).done((function(){return n.updateLocalStatus("on")})),t.fail((function(){return a.request("xhr-error",t)}))}},{key:"punchOut",value:function(){var e,t,n=this;return t=this.model.get("id"),(e=new i({worker_id:t})).fetch().done((function(){var t;return(t=e.save()).done((function(){return n.updateLocalStatus("off")})),t.fail((function(){return a.request("xhr-error",t)}))}))}},{key:"updateLocalStatus",value:function(e){return this.model.set("status",e),this.render(),this.trigger("worker:status:change")}}]),t}(f.View);return e.prototype.tagName="button",e.prototype.className="btn btn-info fa fa-clock-o",e.prototype.template=h.default.renderable((function(e){return h.default.text("Clock "+u[e.status])})),e.prototype.events={click:"punchClock"},e}.call(void 0),t.default=s}}]);
//# sourceMappingURL=company-view-worker-index-eed0908411411a9052ac.js.map