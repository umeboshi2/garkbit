(self.webpackJsonp=self.webpackJsonp||[]).push([[32],{228:function(e,t){},229:function(e,t){},247:function(e,t){},249:function(e,t){},399:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,i,u,a,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=y(n(1)),f=y(n(2)),d=y(n(3)),p=y(n(154)),b=y(n(5)),h=(y(n(222)),y(n(400))),v=y(n(401));function y(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}u=c.default.Radio.channel("global"),s=c.default.Radio.channel("messages"),c.default.Radio.channel("dbadmin"),o=u.request("main:app:AuthModel"),u.request("main:app:AuthCollection"),i=function(){var e=function(e){function t(){return g(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return w(t,o),t}();return e.prototype.url="/api/dev/dbadmin/export-models",e}.call(void 0),r=function(){var e=function(e){function t(){return g(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return w(t,o),t}();return e.prototype.url="/api/dev/dbadmin/delete-models",e}.call(void 0),a=function(){var e=function(e){function t(){return g(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return w(t,f.default.View),l(t,[{key:"onRender",value:function(){var e;return e=new h.default,this.showChildView("dropFile",e)}},{key:"deleteBtnClicked",value:function(){var e;return console.log("deleteBtnClicked"),(e=new r).fetch().done(function(){return s.request("success",e.get("result"))})}},{key:"listBtnClicked",value:function(){return(0,b.default)("#dbadmin/models")}},{key:"exportDatabase",value:function(){var e,t=this;return this.ui.statusMsg.text("Exporting database..."),(e=new i).fetch().done(function(){var n;return n=(0,v.default)(e),p.default.saveAs(n.blob,n.filename),s.request("success","Exported database...."),t.ui.statusMsg.text("sha256: "+e.get("sha256sum"))})}},{key:"IgnoreonDomRefresh",value:function(){return this.jsonView=new JView(this.model.toJSON()),this.ui.jsonView.prepend(this.jsonView.dom)}}]),t}();return e.prototype.template=d.default.renderable(function(e){return d.default.div(".row.listview-header",function(){return d.default.text("Garkbit Dbadmin")}),d.default.div(".row",function(){return d.default.div(".col",function(){return d.default.button(".delete-btn.btn.btn-danger","Delete"),d.default.button(".exportdb-btn.btn.btn-info","Export"),d.default.button(".list-btn.btn.btn-primary","List")})}),d.default.div(".row",function(){return d.default.div(".col",function(){return d.default.div(".listview-header","User Locations"),d.default.div(".list-container")}),d.default.div(".col",function(){return d.default.div(".row.status-message"),d.default.div(".row.dropfile-view")})})}),e.prototype.ui={exportBtn:".exportdb-btn",deleteBtn:".delete-btn",listBtn:".list-btn",statusMsg:".status-message",dropFile:".dropfile-view",listContainer:".list-container"},e.prototype.regions={dropFile:"@ui.dropFile",listContainer:"@ui.listContainer"},e.prototype.events={"click @ui.exportBtn":"exportDatabase","click @ui.deleteBtn":"deleteBtnClicked","click @ui.listBtn":"listBtnClicked"},e}.call(void 0),t.default=a},400:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=u(n(1)),i=(u(n(2)),u(n(3)),u(n(222)));function u(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c,f,d,p,b,h=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};p=r.default.Radio.channel("global"),b=r.default.Radio.channel("messages"),r.default.Radio.channel("dbadmin"),c=p.request("main:app:AuthModel"),p.request("main:app:AuthCollection"),d=function(){var e=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,c),t}();return e.prototype.url="/api/dev/dbadmin/import-models",e}.call(void 0),f=function(){var e=function(e){function t(){a(this,t);var e=s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.successfulParse=e.successfulParse.bind(e),e.fileReaderOnLoad=e.fileReaderOnLoad.bind(e),e}return l(t,i.default),o(t,[{key:"successfulParse",value:function(){return h(this,t),this.ui.statusMsg.text("Parse Successful"),b.request("success","successfulParse")}},{key:"fileReaderOnLoad",value:function(e){var n,o,r,i,u=this;return h(this,t),n=e.target.result,o=e.target.fileObject.name,this.ui.statusMsg.text("Retrieved file content of "+o),i=(r=new d({content:btoa(n)})).save(),this.ui.statusMsg.text("Uploaded "+o+"."),i.fail(function(){return b.request("warning","failed to save model")}),i.done(function(){return console.log("MODEL",r),r.get("data"),r.get("output"),b.request("success","Finished import"),u.ui.statusMsg.text("Finished import")})}}]),t}();return e.prototype.parseMsg="Parse the file",e.prototype.headerMsg="drop a dump of the database to upload",e.prototype.inputId="dbdump-input",e}.call(void 0),t.default=f},401:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n,i,u,a,s,l;return i=e.get("sha256sum"),u=e.get("content"),"production",s={filename:"dbdump-production-"+i.slice(0,5)+".json.xz",type:"application/octet-stream",data:u},t=(0,o.default)(s.data,s.type),n=atob(u),console.log("BLOB",t),console.log("size",t.size,n.length,u.length),a=r.default.hash.sha256.hash,l=(0,r.default.codec.hex.fromBits)(a(n)),console.log("Result",l),console.log("cksum",i),s.blob=t,s};var o=i(n(216)),r=i(n(402));function i(e){return e&&e.__esModule?e:{default:e}}}}]);
//# sourceMappingURL=dbadmin-view-index-e80a2ec4850d83234ac2.js.map