(self.webpackJsonp=self.webpackJsonp||[]).push([[82],{244:function(e,t,o){"use strict";var n=function(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e};function r(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i,l,c,a,s,u;s=o(0),o(4),l=o(1),c=o(2),o(87),u=o(3),o(90),l.Radio.channel("global"),l.Radio.channel("messages"),i=l.Radio.channel("sofi"),a=function(){var e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,c.View),n(r,[{key:"initialize",value:function(e){return this.getOption("comicCollection").on("pageable:state:change",this.onComicCollectionChanged)}},{key:"templateContext",value:function(){return{collection:this.collection}}},{key:"selectionChanged",value:function(e){var t,o,n;return o=this.ui.seriesgroup.val(),t=this.getOption("comicCollection"),n=i.request("locals:get","currentQueryWhere"),"ALL"===o?delete n.seriesgroup:n.seriesgroup=o,i.request("locals:set","currentQueryWhere",n),t.state.currentPage=0,t.fetch({data:{where:n}}).done(function(){return t.state.currentPage=0,t.trigger("pageable:state:change")})}},{key:"onComicCollectionChanged",value:function(e){var t,o,n=this;return function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")}(this,r),t=this.ui.seriesgroup.val(),o=i.request("locals:get","currentQueryWhere"),(null!=(o=s.clone(o))?o.seriesgroup:void 0)&&delete o.seriesgroup,this.collection.fetch({data:{distinct:"seriesgroup",sort:"seriesgroup",where:o}}).done(function(){if(n.render(),n.ui.seriesgroup.val(t),null===n.ui.seriesgroup.val())return n.ui.seriesgroup.val("ALL")})}}]),r);function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments));return e.onComicCollectionChanged=e.onComicCollectionChanged.bind(e),e}return e.prototype.ui={seriesgroup:'select[name="select_seriesgroup"]'},e.prototype.events={"change @ui.seriesgroup":"selectionChanged"},e.prototype.template=u.renderable(function(l){return u.span(".input-group",function(){return u.label(".control-label",{for:"select_seriesgroup"},"Series Group"),u.select(".form-control",{name:"select_seriesgroup"},function(){var e,t,o,n,r,i;for(u.option({value:"ALL",selected:""},"Every Series Group"),i=[],e=0,o=(r=l.items).length;e<o;e++)n={value:(t=r[e]).seriesgroup},i.push(u.option(n,t.seriesgroup));return i})})}),e}.call(void 0),e.exports=a},245:function(e,t,o){"use strict";var r,n,i,l,c,a=function(e,t,o){return t&&s(e.prototype,t),o&&s(e,o),e};function s(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}o(4),n=o(1),i=o(2),o(87),c=o(3),o(90),n.Radio.channel("global"),n.Radio.channel("messages"),r=n.Radio.channel("sofi"),l=function(){var e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.View),a(t,[{key:"templateContext",value:function(){return{collection:this.collection}}},{key:"selectionChanged",value:function(e){var t,o,n;return o=this.ui.publisher.val(),t=this.getOption("comicCollection"),n=r.request("locals:get","currentQueryWhere"),"ALL"===o?delete n.publisher:n.publisher=o,r.request("locals:set","currentQueryWhere",n),t.state.currentPage=0,t.fetch({data:{where:n}}).done(function(){return t.state.currentPage=0,t.trigger("pageable:state:change")})}}]),t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.ui={publisher:'select[name="select_publisher"]'},e.prototype.events={"change @ui.publisher":"selectionChanged"},e.prototype.template=c.renderable(function(l){return c.span(".input-group",function(){return c.label(".control-label",{for:"select_publisher"},"Publisher"),c.select(".form-control",{name:"select_publisher"},function(){var e,t,o,n,r,i;for(c.option({value:"ALL",selected:""},"All publishers"),i=[],e=0,o=(r=l.items).length;e<o;e++)n={value:(t=r[e]).publisher},i.push(c.option(n,t.publisher));return i})})}),e}.call(void 0),e.exports=l},560:function(e,t,o){"use strict";var n,r,i,l,c,a,s,u,p,f,h,d,b,y=function(e,t,o){return t&&g(e.prototype,t),o&&g(e,o),e};function g(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}o(4),r=o(1),p=o(2),o(87),b=o(3),o(90),o(134),l=o(114),a=o(561),u=o(103),r.Radio.channel("global"),r.Radio.channel("messages"),n=r.Radio.channel("sofi"),h=b.renderable(function(e){return b.div("default_entry_template")}),f=n.request("dbComicColumns"),b.renderable(function(i){var l;return l=["seriesgroup","series","issue"],b.span(".input-group",function(){return b.label(".control-label",{for:"select_sortby"},"Sort by"),b.select(".form-control",{name:"select_sortby"},function(){var e,t,o,n,r;for(n={value:"default"},i===l&&(n.selected=""),b.option(n,"default"),r=[],t=0,o=f.length;t<o;t++)n={value:e=f[t]},i===e&&(n.selected=""),r.push(b.option(n,e));return r})})}),c=function(){var e=(_(t,p.NextCollectionView),t);function t(){return v(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.childView=l,e}.call(void 0),d={asc:"ascending",desc:"descending"},s=function(){var e=(_(t,p.View),y(t,[{key:"updateHeader",value:function(){var e,t,o,n;return e=this.collection.state.currentPage,o=this.collection.state.totalPages,n=this.collection.state.totalRecords,t=(t="Page "+(e+1)+" of "+o+", "+d[this.collection.state.sortDirection])+" pages, with "+n+" comics total.",this.triggerMethod("set:header",t)}},{key:"onRender",value:function(){var e,t=this;return e=this.options.entryTemplate||h,this.collectionView=new c({collection:this.collection,entryTemplate:e}),this.showChildView("entries",this.collectionView),this.updateHeader(),this.collection.on("pageable:state:change",function(){return t.updateHeader()})}},{key:"onBeforeDestroy",value:function(){return this.collection.off("pageable:state:change")}}]),t);function t(){return v(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.behaviors=[u],e.prototype.ui={header:".listview-header",entries:".dbcomics-entries"},e.prototype.regions={entries:"@ui.entries"},e.prototype.template=b.renderable(function(e){return b.div(".listview-header"),b.div(".dbcomics-entries.row")}),e}.call(void 0),i=function(){var e=(_(t,p.View),y(t,[{key:"templateContext",value:function(){return this.options}},{key:"onRender",value:function(){var e,t;return e=new a({collection:this.collection}),this.showChildView("sidebar",e),t=new s({collection:this.collection}),this.showChildView("body",t),this.ui.sidebar.css("height","300px"),this.ui.sidebar.droppable()}}]),t);function t(){return v(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=b.renderable(function(e){return b.div(".listview-header",function(){return b.text("DbComics")}),b.div(".row",function(){return b.div(".sidebar.col-sm-4",{style:"height: calc(100% - 50px);"}),b.div(".body.col-sm-8")})}),e.prototype.ui={body:".body",sidebar:".sidebar"},e.prototype.regions={body:"@ui.body",sidebar:"@ui.sidebar"},e}.call(void 0),e.exports=i},561:function(e,t,o){"use strict";var r,n,i,l,c,a,s,u,p,f,h,d,b,y,g,v,w,_=function(e,t,o){return t&&m(e.prototype,t),o&&m(e,o),e};function m(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}o(4),n=o(1),a=o(2),v=o(3),o(90),o(114),o(103),h=o(244),p=o(245),s=o(562),c=n.Radio.channel("global"),n.Radio.channel("messages"),r=n.Radio.channel("sofi"),v.renderable(function(e){return v.div("default_entry_template")}),b=r.request("dbComicColumns"),y=["seriesgroup","series","issue"],g=v.renderable(function(i){return v.span(".input-group",function(){return v.label(".control-label",{for:"select_sortby"},"Sort by"),v.select(".form-control",{name:"select_sortby"},function(){var e,t,o,n,r;for(n={value:"default"},i===y&&(n.selected=""),v.option(n,"default"),r=[],t=0,o=b.length;t<o;t++)n={value:e=b[t]},i===e&&(n.selected=""),r.push(v.option(n,e));return r})})}),i=function(){var e=(x(t,a.View),_(t,[{key:"templateContext",value:function(){return{collection:this.collection}}},{key:"selectionChanged",value:function(e){var t,o,n;return t=this.ui.collectionStatus.val(),o=this.getOption("comicCollection"),n=r.request("locals:get","currentQueryWhere"),"ALL"===t?delete n.list_id:n.list_id=t,r.request("locals:set","currentQueryWhere",n),o.fetch({data:{where:n}}).done(function(){return o.state.currentPage=0,o.trigger("pageable:state:change")})}}]),t);function t(){return k(this,t),C(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.ui={collectionStatus:'select[name="select_collectionstatus"]'},e.prototype.events={"change @ui.collectionStatus":"selectionChanged"},e.prototype.template=v.renderable(function(l){return v.span(".input-group",function(){return v.label(".control-label",{for:"select_collectionstatus"},"Collection Status"),v.select(".form-control",{name:"select_collectionstatus"},function(){var e,t,o,n,r,i;for(v.option({value:"ALL",selected:""},"All Status"),i=[],e=0,o=(r=l.items).length;e<o;e++)n={value:(t=r[e]).id},i.push(v.option(n,t.name));return i})})}),e}.call(void 0),d=function(){var e=(x(t,a.View),_(t,[{key:"templateContext",value:function(){return{collection:this.collection}}},{key:"sort_collection",value:function(){var e,t=this;return"default"===(e=this.ui.sort_by.val())&&(e=y),this.collection.state.sortColumn=e,this.collection.state.currentPage=0,this.collection.fetch({data:{where:r.request("locals:get","currentQueryWhere")}}).done(function(){return t.collection.trigger("pageable:state:change")})}}]),t);function t(){return k(this,t),C(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.ui={sort_by:'select[name="select_sortby"]'},e.prototype.events={"change @ui.sort_by":"sort_collection"},e.prototype.template=v.renderable(function(e){var t;return t=e.collection.state.sortColumn,g(t)}),e}.call(void 0),c.request("main:app:AuthCollection"),f=r.request("db:clzcomic:SeriesGroupCollection"),u=r.request("db:clzcomic:PublisherCollection"),w={navigatorBox:".navigator-box",sortByBox:".sort-by-box",collectionStatusFilterBox:".collection-status-filter-box",publisherFilterBox:".publisher-filter-box",seriesgroupFilterBox:".seriesgroup-filter-box"},l=function(){var e=(x(t,a.View),_(t,[{key:"regions",value:function(){var t;return t={},Object.keys(w).forEach(function(e){return t[e]="@ui."+e}),t}},{key:"templateContext",value:function(){return{collection:this.collection}}},{key:"showCollectionStatus",value:function(){var t,o=this;return(t=r.request("db:clzcollectionstatus:collection")).fetch().done(function(){var e;return e=new i({collection:t,comicCollection:o.collection}),o.showChildView("collectionStatusFilterBox",e)})}},{key:"showSeriesGroupSelect",value:function(){var t,o=this;return(t=new f).fetch({data:{distinct:"seriesgroup",sort:"seriesgroup"}}).done(function(){var e;return e=new h({collection:t,comicCollection:o.collection}),o.showChildView("seriesgroupFilterBox",e),window.sgview=e})}},{key:"showPublisherSelect",value:function(){var t,o=this;return(t=new u).fetch({data:{distinct:"publisher",sort:"publisher"}}).done(function(){var e;return e=new p({collection:t,comicCollection:o.collection}),o.showChildView("publisherFilterBox",e)})}},{key:"showSortBySelect",value:function(){var e;return e=new d({collection:this.collection}),this.showChildView("sortByBox",e)}},{key:"showNavigatorBox",value:function(){var e;return e=new s({collection:this.collection}),this.showChildView("navigatorBox",e)}},{key:"onRender",value:function(){if(this.showNavigatorBox(),this.showCollectionStatus(),this.showPublisherSelect(),this.showSeriesGroupSelect(),this.showSortBySelect(),this.getOption("workspaceSidebar"))return console.warn("workspaceSidebar!!!!!!!!")}}]),t);function t(){return k(this,t),C(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.ui=w,e.prototype.template=v.renderable(function(e){return v.div(".navigator-box.listview-list-entry"),v.div(".sort-by-box.listview-list-entry"),v.div(".collection-status-filter-box.listview-list-entry"),v.div(".publisher-filter-box.listview-list-entry"),v.div(".seriesgroup-filter-box.listview-list-entry")}),e}.call(void 0),e.exports=l},562:function(e,t,o){"use strict";var n=function(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e};function r(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l,c,i,a,s,u;l=o(4),i=o(1),a=o(2),u=o(3),o(90),o(114),o(103),o(244),o(245),o(563),i.Radio.channel("global"),i.Radio.channel("messages"),c=i.Radio.channel("sofi"),u.renderable(function(e){return u.div("default_entry_template")}),c.request("dbComicColumns"),s=function(){var e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,a.View),n(i,[{key:"templateContext",value:function(){return{collection:this.collection}}},{key:"update_nav_buttons",value:function(){var e;if((e=this.collection.state.currentPage)?this.ui.prev_li.show():this.ui.prev_li.hide(),e!==this.collection.state.lastPage?this.ui.next_li.show():this.ui.next_li.hide(),0===this.collection.state.totalRecords)return this.ui.prev_li.hide(),this.ui.next_li.hide()}},{key:"handle_key_command",value:function(e){if("prev"===e||"next"===e)return this.get_another_page(e)}},{key:"keydownHandler",value:function(e){var t,o,n,r;for(t in function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")}(this,i),n=[],o=this.keycommands)r=o[t],e.keyCode===r?n.push(this.handle_key_command(t)):n.push(void 0);return n}},{key:"toggle_sort_direction",value:function(e){var t,o=this;return(t=this.ui.dir_icon).hasClass("fa-arrow-up")?(t.removeClass("fa-arrow-up"),t.addClass("fa-arrow-down"),this.collection.state.sortDirection="desc"):(t.removeClass("fa-arrow-down"),t.addClass("fa-arrow-up"),this.collection.state.sortDirection="asc"),this.collection.fetch({data:{where:c.request("locals:get","currentQueryWhere")}}).done(function(){return o.collection.trigger("pageable:state:change")})}},{key:"onRender",value:function(){var e=this;return this.update_nav_buttons(),this.collection.on("pageable:state:change",function(){return e.update_nav_buttons()}),l("html").keydown(this.keydownHandler)}},{key:"onBeforeDestroy",value:function(){return this.collection.off("pageable:state:change"),l("html").unbind("keydown",this.keydownHandler)}},{key:"get_another_page",value:function(e){var t,o,n,r,i=this;if(r=c.request("locals:get","currentQueryWhere"),this.collection.queryParams.where=r,o=(t=this.collection.state.currentPage)===this.collection.state.lastPage,n=void 0,"prev"===e&&t?n=this.collection.getPreviousPage():"next"!==e||o||(n=this.collection.getNextPage()),n)return n.done(function(){return delete i.collection.queryParams.where})}},{key:"get_prev_page",value:function(){return this.get_another_page("prev")}},{key:"get_next_page",value:function(){return this.get_another_page("next")}}]),i);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return e.keydownHandler=e.keydownHandler.bind(e),e}return e.prototype.tagName="ul",e.prototype.className="pager",e.prototype.ui={prev_li:".previous",next_li:".next",prev_button:".prev-page-button",dir_button:".direction-button",dir_icon:".direction-icon",next_button:".next-page-button"},e.prototype.events={"click @ui.prev_button":"get_prev_page","click @ui.dir_button":"toggle_sort_direction","click @ui.next_button":"get_next_page"},e.prototype.childViewTriggers={"workspace:changed":"workspace:changed"},e.prototype.template=u.renderable(function(e){return u.li(".previous",function(){return u.span(".prev-page-button.btn",function(){return u.i(".fa.fa-arrow-left"),u.text("-previous")})}),u.li(".direction",function(){return u.span(".direction-button.btn",function(){return u.i(".direction-icon.fa.fa-arrow-up")})}),u.li(".next",function(){return u.span(".next-page-button.btn",function(){return u.text("next-"),u.i(".fa.fa-arrow-right")})})}),e.prototype.keycommands={prev:37,next:39},e}.call(void 0),e.exports=s},563:function(e,t,o){"use strict";var n,r,i,l,c,a,s,u,p=function(e,t,o){return t&&f(e.prototype,t),o&&f(e,o),e};function f(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}o(4),r=o(1),l=o(2),u=o(3);var h=o(31);s=h.form_group_input_div,i=r.Radio.channel("global"),r.Radio.channel("messages"),n=r.Radio.channel("sofi"),i.request("main:app:AuthCollection"),c=n.request("db:ebcomicworkspace:WorkspaceCollection"),a=function(){var e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.View),p(t,[{key:"initialize",value:function(){var e=this;return this.collection=new c,this.collection.fetch({data:{distinct:"name",sort:"name"}}).done(function(){return e.render()})}},{key:"templateContext",value:function(){return{collection:this.collection}}},{key:"theWorkspaceChanged",value:function(e){return console.log("theWorkspaceChanged",e)}}]),t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.className="listview-list-entry",e.prototype.ui={name_input:'select[name="select_workspace"]'},e.prototype.triggers={"change @ui.name_input":"workspace:changed"},e.prototype.template=u.renderable(function(l){return s({input_id:"input_wsname",label:"Workspace Name",input_attributes:{name:"name"}}),u.span(".input-group",function(){return u.label(".control-label",{for:"select_workspace"},"Workspace"),u.select(".form-control",{name:"select_workspace"},function(){var e,t,o,n,r,i;if(u.option({value:"UNATTACHED"},"Unattached Comics"),l.items.length){for(i=[],e=0,o=(r=l.items).length;e<o;e++)n={value:(t=r[e]).name},i.push(u.option(n,t.name));return i}return console.log("No workspaces!")})})}),e}.call(void 0),e.exports=a}}]);
//# sourceMappingURL=sofi:views:mainview-592c8199b5317efa8ab1.js.map