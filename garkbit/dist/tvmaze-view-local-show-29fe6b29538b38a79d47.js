(self.webpackJsonp=self.webpackJsonp||[]).push([[85],{486:function(e,t,n){"use strict";var i,o,r,s,u,a,c,l,d,p=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();n(4),o=n(1),u=n(2),d=n(3),n(35),s=n(85),n(86),n(36).default,n(5).navigate_to_url,n(34).form_group_input_div,l=n(84).default,r=n(487),a=o.Radio.channel("messages"),i=o.Radio.channel("tvmaze"),c=function(){var e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.View),p(t,[{key:"onDomRefresh",value:function(){var e;return this.jsonView=new s(this.model.toJSON().content),this.ui.body.prepend(this.jsonView.dom),e=i.request("get-local-episode-collection"),this.localEpisodes=new e,this.showLocalEpisodes()}},{key:"showLocalEpisodes",value:function(){var n=this;return this.localEpisodes.fetch({data:{show_id:this.model.get("id")}}).done(function(){var e,t;return n.localEpisodes.isEmpty()?(a.request("info","Retrieving episodes..."),e=i.request("get-remote-episodes",n.model.id),e.fetch().done(function(){return n.saveEpisodes(e)})):(t=new r({collection:n.localEpisodes}),n.showChildView("episodes",t))})}},{key:"saveEpisodes",value:function(e){var o,r,t=this;return r=this.model.get("id"),o=[],e.models.forEach(function(e){var t,n;return t={id:e.get("id"),show_id:r,content:e.toJSON()},n=i.request("save-local-episode",t),o.push(n)}),Promise.all(o).then(function(e){return o.length&&t.showLocalEpisodes(),a.request("success","Retrieved "+o.length+" episodes.")})}}]),t}();return e.prototype.template=d.renderable(function(t){var n;return n=t.content,d.div(".card.bg-body-d5",function(){return d.div(".row",function(){return d.div(".col-md-2",function(){var e;return(null!=(e=n.image)?e.medium:void 0)?d.img(".card-img-bottom",{src:t.content.image.medium}):l("5x")}),d.div(".col-md-9",function(){return d.div(".card-block",function(){return d.h3(".card-title",t.content.name),d.raw(t.content.summary)})})}),d.div(".row",function(){return d.div(".col-md-8",function(){return d.div(".episode-list-region")}),d.div(".col-md-4",function(){return d.div(".listview-header","ShowObject"),d.div(".jsonview.listview-list-entry",{style:"overflow:auto"})})})})}),e.prototype.ui={body:".jsonview",episodesButton:".episodes-button",saveEpisodesButton:".save-episodes",episodesList:".episode-list-region"},e.prototype.regions={episodes:"@ui.episodesList"},e}.call(void 0),e.exports=c},487:function(e,t,n){"use strict";var o,r,i,s,u,a,c,l=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}o=n(1),u=n(2),c=n(3),s=n(85),n(86),n(5).navigate_to_url,n(34).form_group_input_div,n(84).default,o.Radio.channel("messages"),o.Radio.channel("tvmaze"),a=c.renderable(function(e){return c.div(".card.bg-body-d10",function(){return c.div(".card-header",function(){return e.summary||e.img_med?c.span(".text-local-secondary",{href:"#"},e.name):c.span(".text-light",e.name),c.span(".bg-body-d5.pull-right",function(){return e.season&&(c.span("Season "+e.season),c.raw("&nbsp;&nbsp;&nbsp;")),c.span(".bg-body-d10",e.airdate.toDateString())})}),c.div(".card-block",function(){return c.div(".summary.row",{style:"display:none"},function(){return(null!=e?e.img_med:void 0)?(c.div(".col-md-7",function(){return c.raw(e.summary)}),c.div(".col-md-5",function(){return c.img(".card-img-bottom.pull-right",{src:e.img_med})})):c.div(".col-md-12",function(){return c.raw(e.summary)})}),c.div(".jsonview")})})}),i=function(){var e=function(e){function t(){return d(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,u.View),l(t,[{key:"canShowSummary",value:function(){var e,t;return t=this.model.get("summary"),e=this.model.get("img_med"),t||e}},{key:"showEpisodeSummary",value:function(e){if(e.preventDefault(),this.canShowSummary())return this.ui.summary.toggle()}},{key:"onDomRefreshJsonVIew",value:function(){return this.jsonview=new s(this.model.toJSON()),this.ui.objectContainer.prepend(this.jsonview.dom)}},{key:"handleHover",value:function(){if(this.canShowSummary())return this.$el.css({cursor:"pointer"})}}]),t}();return e.prototype.template=a,e.prototype.ui={summary:".summary",objectContainer:".jsonview"},e.prototype.regions={summary:"@ui.summary",objectContainer:"@ui.objectContainer"},e.prototype.events={click:"showEpisodeSummary",mouseenter:"handleHover"},e}.call(void 0),r=function(){var e=function(e){function t(){return d(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,u.View),l(t,[{key:"onRender",value:function(){var e;return e=new u.CollectionView({collection:this.collection,childView:i}),this.showChildView("itemList",e)}}]),t}();return e.prototype.template=c.renderable(function(e){return c.div(".listview-header",function(){return c.text("Episodes")}),c.div(".episode-list")}),e.prototype.ui={header:".listview-header",itemList:".episode-list"},e.prototype.regions={itemList:"@ui.itemList"},e}.call(void 0),e.exports=r},84:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(3),i=(o=r)&&o.__esModule?o:{default:o};t.default=i.default.renderable(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"5x";return i.default.span(".fa-stack.fa-"+e,function(){return i.default.i(".fa.fa-image.fa-stack-1x"),i.default.i(".fa.fa-ban.fa-stack-2x.text-danger")})})}}]);
//# sourceMappingURL=tvmaze-view-local-show-29fe6b29538b38a79d47.js.map