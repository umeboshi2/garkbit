(self.webpackJsonp=self.webpackJsonp||[]).push([[32],{409:function(e,t,n){"use strict";var o=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,l,a,f,d,p,v,h,b,y,m,w,_,g,k,x,O,j,q,C,P=[].indexOf;n(4),l=n(1),b=n(2),n(87),C=n(3),O=n(89),n(5);var V=n(31);V.make_field_input,V.make_field_select,n(31).form_group_input_div;var E=n(17);q=E.modal_close_button,h=l.Radio.channel("global"),y=l.Radio.channel("messages"),s=l.Radio.channel("ebcsv"),a=h.request("main:app:BaseModalView"),x=new l.Collection,s.reply("get-csvrow-collection",function(){return x}),j=function(){var e,t,n;for(t in n=[],e=s.request("get-csv-header"))n.push(e[t]);return""+n.join(",")},k=function(){var e,t,n,o,r,i,c,u,l,a;for(e=s.request("get-csvrow-collection"),s.request("get-csv-header"),c=[j()],o=0,r=(u=e.models).length;o<r;o++){for(n in a=[],t=u[o].toJSON())l=(l=t[n]).split('"').join('""'),0<=P.call(l," ")&&(l='"'+l+'"'),a.push(l);i=a.join(","),c.push(i)}return c.join("\r\n")+"\r\n"},m=function(){var e=(u(t,a),t);function t(){return i(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=C.renderable(function(e){return e.mainsection,C.div(".modal-dialog",function(){return C.div(".modal-content",function(){return C.h4("Title: "+e.Title),C.div(".modal-body",function(){return C.h4("Description:"),C.hr(),C.div(".panel",function(){return C.raw(e.Description)})}),C.div(".modal-footer",function(){return C.ul(".list-inline",function(){return"btn.btn-default.btn-sm",C.li("#close-modal",function(){return q("Close","check")})})})})})}),e}.call(void 0),w=function(){var e=(u(t,a),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).csvheader=s.request("get-csv-header"),e}}]),t);function t(){return i(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=C.renderable(function(t){return C.div(".modal-dialog",function(){return C.div(".modal-content",function(){return C.h3("Title: "+t.Title),C.div(".modal-body",function(){return C.h4("CSV Row:"),C.hr(),C.div(".panel",function(){return C.dl(".dl-horizontal",function(){return Object.keys(t).forEach(function(e){return C.dt(t.csvheader[e]),C.dd(t[e])})})})}),C.div(".modal-footer",function(){return C.ul(".list-inline",function(){return C.li("#close-modal",function(){return q("Close","check")})})})})})}),e}.call(void 0),g=["max-width:0","overflow:hidden","text-overflow:ellipsis","white-space:nowrap"].join(";")+";",v=function(){var e=(u(t,b.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).csvheader=s.request("get-csv-header"),e}},{key:"show_row",value:function(){var e;return e=new w({model:this.model}),h.request("show-modal",e)}},{key:"show_description",value:function(){var e;return e=new m({model:this.model}),h.request("show-modal",e)}}]),t);function t(){return i(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.tagName="tr",e.prototype.template=C.renderable(function(t){return C.td(function(){return C.div(".btn-group.btn-group-justified",function(){return C.div(".show-desc-button.btn.btn-default.btn-xs",function(){return C.i(".fa.fa-eye")}),C.div(".show-row-button.btn.btn-default.btn-xs",function(){return C.i(".fa.fa-list")})})}),Object.keys(t.csvheader).forEach(function(e){return C.td({style:g},t[e])})}),e.prototype.ui={desc_btn:".show-desc-button",row_btn:".show-row-button"},e.prototype.events={"click @ui.desc_btn":"show_description","click @ui.row_btn":"show_row"},e}.call(void 0),p=function(){var e=(u(t,b.CollectionView),t);function t(){return i(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.tagName="tbody",e.prototype.childView=v,e}.call(void 0),_=["table","table-striped","table-bordered","table-hover","table-condensed"],d=function(){var e=(u(t,b.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).ebcfg_collection=s.request("ebcfg-collection"),e.ebdsc_collection=s.request("ebdsc-collection"),e.csvheader=s.request("get-csv-header"),e}},{key:"onRender",value:function(){var e,t;return e=s.request("get-csvrow-collection"),t=new p({collection:e}),this.showChildView("body",t)}}]),t);function t(){return i(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.tagName="table",e.prototype.className=_.join(" "),e.prototype.template=C.renderable(function(t){return C.div(".table-responsive",function(){return C.table("."+_.join("."),function(){return C.thead(function(){return C.tr(".info",function(){return C.td(function(){return C.i(".fa.fa-eye.fa-3x")}),Object.keys(t.csvheader).forEach(function(e){return C.th(t.csvheader[e])})})}),C.tbody()})})}),e.prototype.regions={body:{el:"tbody",replaceElement:!0}},e}.call(void 0),f=function(){var e=(u(t,b.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).ebcfg_collection=s.request("ebcfg-collection"),e.ebdsc_collection=s.request("ebdsc-collection"),e}},{key:"open_fileexchange_tab",value:function(){return window.open("http://bulksell.ebay.com/ws/eBayISAPI.dll?FileExchangeUploadForm","_blank")}},{key:"make_csv_file",value:function(){var e,t,n,o;return k(),t=new Date,o=O(t,"yyyy-mm-dd-HH:MM:ss"),e=this.ui.filename_input.val()||"export-"+o+".csv",n={type:"data:text/csv;charset=utf-8",data:k(),el_id:"exported-csv-anchor",filename:e},h.request("export-to-file",n)}},{key:"createCsvRows",value:function(){var e,t,n,o,r,i,c,u,l;for(e=s.request("get-current-csv-action"),n=s.request("get-current-csv-cfg"),o=s.request("get-current-csv-dsc"),l=[],r=0,i=(u=this.collection.toJSON()).length;r<i;r++)c={action:e,comic:u[r],cfg:n,desc:o},t=s.request("create-csv-row-object",c),l.push(t);return s.request("get-csvrow-collection").set(l)}},{key:"onRender",value:function(){var e,t,n;return t=s.request("get-comic-image-urls"),Object.keys(t).length||y.request("warning","No pictures attached, please view comics, then create csv"),this.createCsvRows(),e=s.request("get-csvrow-collection"),n=new d({collection:e}),this.showChildView("body",n)}}]),t);function t(){return i(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.regions={body:".body"},e.prototype.template=C.renderable(function(e){var t,n;return n=new Date,t="export-"+O(n,"mmddHHMM")+".csv",C.div(".listview-header",function(){return C.text("Preview CSV")}),C.div(".fileexchange-button.btn.btn-default","Ebay Upload"),C.div(".mkcsv-button.btn.btn-default","Create CSV"),C.input(".form-control",{value:t,name:"csvfilename"}),C.div(".body")}),e.prototype.ui={mkcsv_btn:".mkcsv-button",filename_input:"input[name='csvfilename']",fileexchange_btn:".fileexchange-button"},e.prototype.events={"click @ui.mkcsv_btn":"make_csv_file","click @ui.fileexchange_btn":"open_fileexchange_tab"},e}.call(void 0),e.exports=f}}]);
//# sourceMappingURL=ebcsv-view-csvpreview-view-helper-e246d1a5d33fa6d9afd0.js.map