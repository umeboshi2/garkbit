(self.webpackJsonp=self.webpackJsonp||[]).push([[79],{1091:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r,i,u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(1),l=n(3),c=d(n(6)),f=d(n(0)),s=d(n(631)),p=d(n(392));function d(t){return t&&t.__esModule?t:{default:t}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}o=a.Radio.channel("pmc"),i=function(){var t=function(t){function e(){return b(this,e),h(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return y(e,t),u(e,[{key:"templateContext",value:function(){return{hasOAIcontent:this.model.hasOAIcontent()}}},{key:"onRender",value:function(){var t;if(this.model.hasOAIcontent())return t=new p.default({model:this.model}),this.showChildView("content",t)}},{key:"buttonClicked",value:function(){var t,e;if(e=this,!(t=this.model).get("content"))return t.fetch().done((function(){var n,r;return r=Number(t.get("id")),n=t.get("content"),o.request("save-fm-content",r,n).then((function(){var t;return(t=o.request("get-fm-collection")).fetch().done((function(){var n,o;return n=t.get(r),e.model=n,o=new p.default({model:n}),e.showChildView("content",o),e.ui.button.hide()}))}))}))}}]),e}(l.View);return t.prototype.template=c.default.renderable((function(t){return c.default.text("PMCID: PMC"+t.id+" "),t.hasOAIcontent||(".btn.btn-outline-warning.btn-sm",c.default.button(".dl-btn.btn.btn-outline-warning.btn-sm.fa.fa-download",(function(){return" Download Front Matter"}))),c.default.div(".content")})),t.prototype.ui={content:".content",button:".dl-btn"},t.prototype.regions={content:"@ui.content"},t.prototype.events={"click @ui.button":"buttonClicked"},t}.call(void 0),r=function(){var t=function(t){function e(){return b(this,e),h(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return y(e,t),u(e,[{key:"onRender",value:function(){var t;return t=new s.default,this.showChildView("searchInput",t)}},{key:"searchClicked",value:function(t){return this.searchTerm(t.value)}},{key:"searchTerm",value:function(t){var e,n=this;return console.log("searchTerm",t),(e=o.request("make-search-model",t)).fetch().done((function(){var t,r,u,c;return r=new a.Collection([]),t=o.request("get-fm-collection"),u=e.get("eSearchResult"),f.default.map(u.IdList.Id,Number).forEach((function(n){var i;return null!=(i=t.get(n))?(console.log("LOCAL model found",i),e=i):e=o.request("make-remote-model",n),r.add(e)})),c=new l.CollectionView({collection:r,childView:i}),n.showChildView("content",c)}))}}]),e}(l.View);return t.prototype.template=c.default.renderable((function(){return c.default.div(".search-input"),c.default.div(".content")})),t.prototype.ui={searchInput:".search-input",content:".content",button:"button",input:"input"},t.prototype.regions={content:"@ui.content",searchInput:"@ui.searchInput"},t.prototype.childViewEvents={"input:submit":"searchClicked"},t}.call(void 0),e.default=r},381:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r,i,u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(1),l=n(3),c=n(107),f=(o=c)&&o.__esModule?o:{default:o};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}i=a.Radio.channel("global"),r=function(){var t=function(t){function e(){return s(this,e),p(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),u(e,[{key:"emptyModal",value:function(){return i.request("main:app:object").getView().getRegion("modal").empty()}}]),e}(l.View);return t.prototype.behaviors=[f.default],t}.call(void 0),e.default=r},392:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r,i,u,a,l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),c=n(1),f=n(3),s=w(n(6)),p=n(388),d=w(n(375)),b=w(n(57)),h=w(n(236)),y=w(n(393)),v=w(n(394)),m=w(n(395)),_=w(n(396));function w(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function k(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}r=c.Radio.channel("global"),o=c.Radio.channel("pmc"),u=function(){var t=function(t){function e(){return g(this,e),O(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return k(e,t),l(e,[{key:"viewClicked",value:function(){var t;return t=this.model.get("name"),(0,b.default)("#pmc/topics/"+t)}}]),e}(f.View);return t.prototype.tagName="span",t.prototype.className="badge badge-primary",t.prototype.template=s.default.renderable((function(t){return s.default.text(t.name)})),t.prototype.behaviors=[d.default],t.prototype.events={click:"viewClicked"},t}.call(void 0),a=function(){var t=function(t){function e(){return g(this,e),O(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return k(e,t),e}(f.CollectionView);return t.prototype.childView=u,t}.call(void 0),i=function(){var t=function(t){function e(){return g(this,e),O(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return k(e,t),l(e,[{key:"onRender",value:function(){var t,e,n,r,i,u=this;return this.ui.jsonView.hide(),this.ui.topicsBtn.hide(),r=new c.Collection,e=this.model.id,i=o.request("get-topic-collection"),t=o.request("get-fmtopic-collection"),n=[i.fetch(),t.fetch()],Promise.all(n).then((function(){var n;return[],t.filter({pmcid:e}).forEach((function(t){var e,n;return n=t.get("topic_id"),e=i.get(n).get("name"),r.add({id:e,name:e})})),n=new a({collection:r}),u.showChildView("topicsList",n)}))}},{key:"pmcAnchorClicked",value:function(t){return t.preventDefault()}},{key:"deleteBtnClicked",value:function(){var t=this;return this.model.destroy().done((function(){return t.trigger("model:destroyed")}))}},{key:"abstractBtnClicked",value:function(){return this.ui.abstractCard.toggle()}},{key:"topicsBtnClicked",value:function(){var t;return t=new _.default({model:this.model}),r.request("show-modal",t)}}]),e}(f.View);return t.prototype.behaviors=[h.default],t.prototype.template=s.default.renderable((function(t){var e,n,o;return o=(0,p.JSONPath)("*..article-meta",t)[0],e=(0,y.default)(t),n=(0,v.default)(t.id),s.default.div(".card",(function(){return s.default.div(".card-body",(function(){var r;return s.default.h5(".card-title",(function(){return s.default.a({href:"#pmc/view/"+t.id},e.title)})),s.default.div(".small",e.journal),s.default.a(".pmc-anchor.small",{href:n},"(PMC)"),(null!=e?e.doi:void 0)&&s.default.a(".small",{href:(0,m.default)(e.doi),target:"_blank"},(function(){return s.default.text(" (doi:"+e.doi+")")})),s.default.span(".destroy-btn.badge.badge-danger",{type:"button"},"Delete"),(null!=o?o.abstract:void 0)&&(r=o.abstract,s.default.span(".abstract-btn.badge.badge-dark",{type:"button"},(function(){return s.default.text("toggle abstract")})),s.default.div(".abstract-card.card-text",{style:"display: none;"},(function(){var t,e,n,i,u,a,l,c,f,p,d,b,h,y;if(s.default.text("Abstract"),null!=r?r.sec:void 0){for(h=[],n=0,a=(f=o.abstract.sec).length;n<a;n++)i=f[n],s.default.h6(".card-text.small",i.title),c=(null!=(p=i.p)?p.__text:void 0)?i.p.__text:i.p,h.push(s.default.p(".card-text.small",c));return h}if(null!=(e=(null!=(d=(t=r).p)?d.__text:void 0)?t.p.__text:t.p)?e.length:void 0)return s.default.div(".card-text.small",e);for(y=[],u=0,l=t.length;u<l;u++)c=(i=t[u]).p,(null!=(b=i.p)?b.__text:void 0)&&(c=i.p.__text),y.push(s.default.p(".card-text.small",c));return y}))),s.default.div(".abstract-container"),s.default.div(".card-footer",(function(){return s.default.span(".topics-list.small.font-italic"),s.default.span(".topics-btn.badge.badge-dark",{type:"button"},"assign topics")}))})),s.default.div(".jsonview")}))})),t.prototype.ui={pmcAnchor:".pmc-anchor",deleteBtn:".destroy-btn",jsonView:".jsonview",abstractCard:".abstract-card",abstractBtn:".abstract-btn",topicsBtn:".topics-btn",topicsList:".topics-list"},t.prototype.regions={topicsList:"@ui.topicsList"},t.prototype.events={"click @ui.pmcAnchor":"pmcAnchorClicked","click @ui.deleteBtn":"deleteBtnClicked","click @ui.abstractBtn":"abstractBtnClicked","click @ui.topicsBtn":"topicsBtnClicked"},t}.call(void 0),e.default=i},393:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r,i=n(0),u=((o=i)&&o.__esModule,n(388));r=function(t){var e,n,o;return(null!=(n=(0,u.JSONPath)("*..OAI-PMH",t)[0])?n.error:void 0)?{}:{journal:(0,u.JSONPath)("*..journal-title",n)[0],title:(null!=(o=(0,u.JSONPath)("*..article-title",n)[0])?o.__text:void 0)?o.__text:o,doi:null!=(e=(0,u.JSONPath)('*..article-id[?(@["_pub-id-type"]=="doi")]',n)[0])?e.__text:void 0}},e.default=r},394:function(t,e,n){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return o+"PMC"+t+"/"},o="https://www.ncbi.nlm.nih.gov/pmc/articles/"},395:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return"https://dx.doi.org/","https://dx.doi.org/"+t}},396:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r,i,u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(1),l=n(3),c=d(n(6)),f=d(n(381)),s=d(n(236)),p=d(n(105));function d(t){return t&&t.__esModule?t:{default:t}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}o=a.Radio.channel("pmc"),i=function(){var t=function(t){function e(){return b(this,e),h(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return y(e,t),e}(l.View);return t.prototype.behaviors=[s.default],t.prototype.template=c.default.renderable((function(){return c.default.div(".jsonview")})),t}.call(void 0),r=function(){var t=function(t){function e(){return b(this,e),h(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return y(e,t),u(e,[{key:"okBtnClicked",value:function(){return console.log("OK clicked")}},{key:"onRender",value:function(){var t,e,n,r;return r=o.request("get-topic-collection"),t=o.request("get-fmtopic-collection"),console.log("topics, fmtopics",r,t),n=this,e=new a.Model({topics:r,fmtopics:t,eventIndex:p.default.eventIndex}),r.fetch().then((function(){return t.fetch()})).then((function(){var o;return console.log("all fetched",r,t),o=new i({model:e}),n.showChildView("content",o)}))}}]),e}(f.default);return t.prototype.template=c.default.renderable((function(t){return console.log("model",t),c.default.div(".modal-dialog.modal-md",(function(){return c.default.div(".modal-content",(function(){return c.default.text("Topics Assigned to pmeid: "+t.id),c.default.div(".content"),c.default.div(".row",(function(){return c.default.button(".close-btn.btn.btn-warning.fa.fa-close.mr-auto",{data:{dismiss:"modal"}},"Close"),c.default.button(".ok-button.btn.btn-success.fa.fa-check.ml-auto","Ok")}))}))}))})),t.prototype.ui={closeBtn:".close-btn",okBtn:".ok-button",content:".content",topicsRegion:".topics"},t.prototype.regions={content:"@ui.content"},t.prototype.events={"click @ui.okBtn":"okBtnClicked","click @ui.closeBtn":"emptyModal"},t}.call(void 0),e.default=r},631:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),a=n(6),l=(o=a)&&o.__esModule?o:{default:o};function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}r=function(){var t=function(t){function e(){return c(this,e),f(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"templateContext",value:function(){return{buttonText:this.getOption("buttonText")||"Search",placeholder:this.getOption("placeholder")||"Enter search term",buttonClass:this.getOption("buttonClass")||".btn.btn-outline-warning"}}},{key:"buttonClicked",value:function(){var t;if(null!=(t=this.ui.input.val().trim()))return this.trigger("input:submit",{value:t})}}]),e}(u.View);return t.prototype.template=l.default.renderable((function(t){return l.default.div(".input-group",(function(){return l.default.div(".input-group-prepend",(function(){return l.default.button(".input-group-text"+t.buttonClass,t.buttonText)})),l.default.input(".form-control",{type:"text",placeholder:t.placeholder})}))})),t.prototype.ui={button:"button",input:"input"},t.prototype.events={"click @ui.button":"buttonClicked"},t}.call(void 0),e.default=r}}]);
//# sourceMappingURL=pmc-view-search-pmc-6cebf78640d5e376d57a.js.map