(self.webpackJsonp=self.webpackJsonp||[]).push([[47],{463:function(e,t,n){"use strict";var o=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u,l,i,a,c,s,f,p,d=w(n(1)),h=w(n(2)),y=w(n(3)),v=(w(n(32)),w(n(5)),w(n(464)));function w(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}d.default.Radio.channel("global"),i=d.default.Radio.channel("messages"),u=d.default.Radio.channel("hourly"),p=y.default.renderable(function(e){return y.default.div(".row.status")}),s=y.default.renderable(function(e){return y.default.div(".row.listview-list-entry",function(){return y.default.text("You are not a worker.")})}),a=function(){var e=(k(t,h.default.View),t);function t(){return b(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=s,e}.call(void 0),f=y.default.renderable(function(e){var t;return y.default.div(".row.listview-list-entry",function(){return y.default.text(e.user.fullname+" is a worker.")}),t="in",null===e.status&&y.default.div(".row.listview-list-entry",function(){return y.default.text(e.user.fullname+" has never clocked in.")}),"on"===e.status&&(t="out"),y.default.div(".row.listview-list-entry",function(){return y.default.button(".clock-btn.btn-info.fa.fa-clock-o",function(){return y.default.text("Clock "+t)})})}),c=function(){var e=(k(t,h.default.View),o(t,[{key:"ui",value:function(){return{clockBtn:".clock-btn"}}},{key:"events",value:function(){return{"click @ui.clockBtn":"punchClock"}}},{key:"punchClock",value:function(){var e,t;return t=this.model,e=this.model.get("status"),console.log("punchClock",t,e),"off"===e||null===e?this.punchIn():"on"===e?this.punchOut():i.request("warning","Bad worker status "+e)}},{key:"punchIn",value:function(){var e,t=this;return this.model.get("id"),(e=new v.default).save(null,{type:"POST",url:e.urlRoot}).done(function(){return t.render()})}},{key:"punchOut",value:function(){var e,t,n=this;return t=this.model.get("id"),(e=new v.default({worker_id:t})).fetch().done(function(){return console.log("clock is",e),console.log("Session id",e.get("id")),e.save().done(function(){return n.render()})})}},{key:"insertNewStatus",value:function(){var e;return e=this.model,new(u.request("status-modelClass"))({worker_id:e.get("id")}),response}}]),t);function t(){return b(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=f,e}.call(void 0),l=function(){var e=(k(t,h.default.View),o(t,[{key:"ui",value:function(){return{status:".status"}}},{key:"onRender",value:function(){var e,t=this;return console.log("MODEL IS",this.model),(e=this.model.fetch()).done(function(){var e;return e=new c({model:t.model}),t.showChildView("status",e)}),e.fail(function(){var e;return e=new a({model:t.model}),t.showChildView("status",e)})}}]),t);function t(){return b(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=p,e.prototype.regions={status:"@ui.status"},e.prototype.templateContext={appName:"hourly"},e}.call(void 0),e.exports=l},464:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,u,l,i=n(1),a=(o=i)&&o.__esModule?o:{default:o};n(117);u=a.default.Radio.channel("global"),a.default.Radio.channel("hourly"),r=u.request("main:app:AuthModel"),u.request("main:app:AuthCollection"),l=function(){var e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r),t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.urlRoot="/api/dev/hourly/time-clock",e}.call(void 0),t.default=l}}]);
//# sourceMappingURL=hourly-view-index-e314921da11a548d3e96.js.map