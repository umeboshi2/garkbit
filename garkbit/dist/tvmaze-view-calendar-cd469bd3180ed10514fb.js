(self.webpackJsonp=self.webpackJsonp||[]).push([[89],{1164:function(s,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function s(s,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,n.key,n)}}return function(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}}(),j=u(t(7)),a=t(1),r=t(3),o=u(t(6)),i=u(t(31)),l=u(t(224));function u(s){return s&&s.__esModule?s:{default:s}}function c(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function d(s,e){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?s:e}t(635),t(650);var f,h,m,b,p,v,g;m=a.Radio.channel("global"),f=a.Radio.channel("tvmaze"),b=o.default.renderable((function(){return o.default.div(".listview-header","Episodes"),o.default.div(".loading",(function(){return o.default.h2((function(){return o.default.i(".fa.fa-spinner.fa-spin"),o.default.text("Loading Episodes")}))})),o.default.div(".maincalendar")})),g=function(s,e){return s.url="#tvmaze/shows/view/"+s.showId,e.css({cursor:"pointer","font-size":"0.9em","font-family":"Rambla"})},v=function(s){var e,t;return t=(0,j.default)(".loading"),e=(0,j.default)(".fc-toolbar"),s?(t.show(),e.hide()):(t.hide(),e.show())},p=function(s,e,t,n){var j,r,o,u,c,d;return d=(j=m.request("main:app:dbConn","tvmaze")).getSchema().table("TVMazeEpisode"),o=[],window.startMoment=s,c=s.toDate(),r=e.toDate(),o.push(d.airdate.gte(s)),o.push(d.airdate.lte(e)),u=j.select().from(d).where(i.default.op.and(d.airdate.gte(s.toDate()),d.airdate.lte(e.toDate()))),console.log("Q",u,c,r),u=u.exec(),console.log("Q",u),u.then((function(s){var e,t,j;return console.log("RESULTS",s),(e=new a.Collection).set(s),t=e.toJSON(),console.log("collection",e),j=[],t.forEach((function(s){var e,t,n;return e=(0,l.default)(s.airdate),n=s.runtime||30,t={id:s.id,showId:s.show_id,title:s.name,allDay:!1,start:e,end:e.add(n,"minutes"),url:"#tvmaze/shows/view/"+s.show_id},j.push(t)})),n(j)}))},h=function(){var s=function(s){function e(){c(this,e);var s=d(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments));return s.calendarViewRender=s.calendarViewRender.bind(s),s}return function(s,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):s.__proto__=e)}(e,s),n(e,[{key:"onBeforeDestroy",value:function(){this.ui.calendar.fullCalendar("destroy")}},{key:"calendarViewRender",value:function(s,t){return function(s,e){if(!(s instanceof e))throw new Error("Bound instance method accessed before binding")}(this,e),f.request("maincalendar:set-date",this.ui.calendar)}},{key:"onDomRefresh",value:function(){var s,e,t=this;return s=function(s){var e,n;return t.options.minicalendar?(e={layout:t.options.layout,region:"episode",id:s.id},f.request("view-episode",e)):(n=s.url,console.log("EVENT URL",s,n),a.history.navigate(n,{trigger:!0}))},e=f.request("maincalendar:get-date"),this.ui.calendar.fullCalendar({defaultDate:e,header:{left:"prevYear, nextYear",center:"title",right:"prev, next"},theme:!1,defaultView:"month",eventSources:[{events:p}],eventRender:g,viewRender:this.calendarViewRender,loading:v,eventClick:s}),console.log("we should either be fetching events, or refetching")}}]),e}(r.View);return s.prototype.template=b,s.prototype.ui={calendar:".maincalendar",loading:".loading",header:".fc-toolbar",daytop:".fc-day-top"},s.prototype.options={minicalendar:!1,layout:!1},s}.call(void 0),e.default=h},403:function(s,e,t){var n={"./af":240,"./af.js":240,"./ar":241,"./ar-dz":242,"./ar-dz.js":242,"./ar-kw":243,"./ar-kw.js":243,"./ar-ly":244,"./ar-ly.js":244,"./ar-ma":245,"./ar-ma.js":245,"./ar-sa":246,"./ar-sa.js":246,"./ar-tn":247,"./ar-tn.js":247,"./ar.js":241,"./az":248,"./az.js":248,"./be":249,"./be.js":249,"./bg":250,"./bg.js":250,"./bm":251,"./bm.js":251,"./bn":252,"./bn-bd":253,"./bn-bd.js":253,"./bn.js":252,"./bo":254,"./bo.js":254,"./br":255,"./br.js":255,"./bs":256,"./bs.js":256,"./ca":257,"./ca.js":257,"./cs":258,"./cs.js":258,"./cv":259,"./cv.js":259,"./cy":260,"./cy.js":260,"./da":261,"./da.js":261,"./de":262,"./de-at":263,"./de-at.js":263,"./de-ch":264,"./de-ch.js":264,"./de.js":262,"./dv":265,"./dv.js":265,"./el":266,"./el.js":266,"./en-au":267,"./en-au.js":267,"./en-ca":268,"./en-ca.js":268,"./en-gb":269,"./en-gb.js":269,"./en-ie":270,"./en-ie.js":270,"./en-il":271,"./en-il.js":271,"./en-in":272,"./en-in.js":272,"./en-nz":273,"./en-nz.js":273,"./en-sg":274,"./en-sg.js":274,"./eo":275,"./eo.js":275,"./es":276,"./es-do":277,"./es-do.js":277,"./es-mx":278,"./es-mx.js":278,"./es-us":279,"./es-us.js":279,"./es.js":276,"./et":280,"./et.js":280,"./eu":281,"./eu.js":281,"./fa":282,"./fa.js":282,"./fi":283,"./fi.js":283,"./fil":284,"./fil.js":284,"./fo":285,"./fo.js":285,"./fr":286,"./fr-ca":287,"./fr-ca.js":287,"./fr-ch":288,"./fr-ch.js":288,"./fr.js":286,"./fy":289,"./fy.js":289,"./ga":290,"./ga.js":290,"./gd":291,"./gd.js":291,"./gl":292,"./gl.js":292,"./gom-deva":293,"./gom-deva.js":293,"./gom-latn":294,"./gom-latn.js":294,"./gu":295,"./gu.js":295,"./he":296,"./he.js":296,"./hi":297,"./hi.js":297,"./hr":298,"./hr.js":298,"./hu":299,"./hu.js":299,"./hy-am":300,"./hy-am.js":300,"./id":301,"./id.js":301,"./is":302,"./is.js":302,"./it":303,"./it-ch":304,"./it-ch.js":304,"./it.js":303,"./ja":305,"./ja.js":305,"./jv":306,"./jv.js":306,"./ka":307,"./ka.js":307,"./kk":308,"./kk.js":308,"./km":309,"./km.js":309,"./kn":310,"./kn.js":310,"./ko":311,"./ko.js":311,"./ku":312,"./ku.js":312,"./ky":313,"./ky.js":313,"./lb":314,"./lb.js":314,"./lo":315,"./lo.js":315,"./lt":316,"./lt.js":316,"./lv":317,"./lv.js":317,"./me":318,"./me.js":318,"./mi":319,"./mi.js":319,"./mk":320,"./mk.js":320,"./ml":321,"./ml.js":321,"./mn":322,"./mn.js":322,"./mr":323,"./mr.js":323,"./ms":324,"./ms-my":325,"./ms-my.js":325,"./ms.js":324,"./mt":326,"./mt.js":326,"./my":327,"./my.js":327,"./nb":328,"./nb.js":328,"./ne":329,"./ne.js":329,"./nl":330,"./nl-be":331,"./nl-be.js":331,"./nl.js":330,"./nn":332,"./nn.js":332,"./oc-lnc":333,"./oc-lnc.js":333,"./pa-in":334,"./pa-in.js":334,"./pl":335,"./pl.js":335,"./pt":336,"./pt-br":337,"./pt-br.js":337,"./pt.js":336,"./ro":338,"./ro.js":338,"./ru":339,"./ru.js":339,"./sd":340,"./sd.js":340,"./se":341,"./se.js":341,"./si":342,"./si.js":342,"./sk":343,"./sk.js":343,"./sl":344,"./sl.js":344,"./sq":345,"./sq.js":345,"./sr":346,"./sr-cyrl":347,"./sr-cyrl.js":347,"./sr.js":346,"./ss":348,"./ss.js":348,"./sv":349,"./sv.js":349,"./sw":350,"./sw.js":350,"./ta":351,"./ta.js":351,"./te":352,"./te.js":352,"./tet":353,"./tet.js":353,"./tg":354,"./tg.js":354,"./th":355,"./th.js":355,"./tk":356,"./tk.js":356,"./tl-ph":357,"./tl-ph.js":357,"./tlh":358,"./tlh.js":358,"./tr":359,"./tr.js":359,"./tzl":360,"./tzl.js":360,"./tzm":361,"./tzm-latn":362,"./tzm-latn.js":362,"./tzm.js":361,"./ug-cn":363,"./ug-cn.js":363,"./uk":364,"./uk.js":364,"./ur":365,"./ur.js":365,"./uz":366,"./uz-latn":367,"./uz-latn.js":367,"./uz.js":366,"./vi":368,"./vi.js":368,"./x-pseudo":369,"./x-pseudo.js":369,"./yo":370,"./yo.js":370,"./zh-cn":371,"./zh-cn.js":371,"./zh-hk":372,"./zh-hk.js":372,"./zh-mo":373,"./zh-mo.js":373,"./zh-tw":374,"./zh-tw.js":374};function j(s){var e=a(s);return t(e)}function a(s){if(!t.o(n,s)){var e=new Error("Cannot find module '"+s+"'");throw e.code="MODULE_NOT_FOUND",e}return n[s]}j.keys=function(){return Object.keys(n)},j.resolve=a,s.exports=j,j.id=403},636:function(s,e,t){var n={"./af":421,"./af.js":421,"./ar":422,"./ar-dz":423,"./ar-dz.js":423,"./ar-kw":424,"./ar-kw.js":424,"./ar-ly":425,"./ar-ly.js":425,"./ar-ma":426,"./ar-ma.js":426,"./ar-sa":427,"./ar-sa.js":427,"./ar-tn":428,"./ar-tn.js":428,"./ar.js":422,"./az":429,"./az.js":429,"./be":430,"./be.js":430,"./bg":431,"./bg.js":431,"./bm":432,"./bm.js":432,"./bn":433,"./bn.js":433,"./bo":434,"./bo.js":434,"./br":435,"./br.js":435,"./bs":436,"./bs.js":436,"./ca":437,"./ca.js":437,"./cs":438,"./cs.js":438,"./cv":439,"./cv.js":439,"./cy":440,"./cy.js":440,"./da":441,"./da.js":441,"./de":442,"./de-at":443,"./de-at.js":443,"./de-ch":444,"./de-ch.js":444,"./de.js":442,"./dv":445,"./dv.js":445,"./el":446,"./el.js":446,"./en-au":447,"./en-au.js":447,"./en-ca":448,"./en-ca.js":448,"./en-gb":449,"./en-gb.js":449,"./en-ie":450,"./en-ie.js":450,"./en-il":451,"./en-il.js":451,"./en-in":452,"./en-in.js":452,"./en-nz":453,"./en-nz.js":453,"./en-sg":454,"./en-sg.js":454,"./eo":455,"./eo.js":455,"./es":456,"./es-do":457,"./es-do.js":457,"./es-us":458,"./es-us.js":458,"./es.js":456,"./et":459,"./et.js":459,"./eu":460,"./eu.js":460,"./fa":461,"./fa.js":461,"./fi":462,"./fi.js":462,"./fil":463,"./fil.js":463,"./fo":464,"./fo.js":464,"./fr":465,"./fr-ca":466,"./fr-ca.js":466,"./fr-ch":467,"./fr-ch.js":467,"./fr.js":465,"./fy":468,"./fy.js":468,"./ga":469,"./ga.js":469,"./gd":470,"./gd.js":470,"./gl":471,"./gl.js":471,"./gom-deva":472,"./gom-deva.js":472,"./gom-latn":473,"./gom-latn.js":473,"./gu":474,"./gu.js":474,"./he":475,"./he.js":475,"./hi":476,"./hi.js":476,"./hr":477,"./hr.js":477,"./hu":478,"./hu.js":478,"./hy-am":479,"./hy-am.js":479,"./id":480,"./id.js":480,"./is":481,"./is.js":481,"./it":482,"./it-ch":483,"./it-ch.js":483,"./it.js":482,"./ja":484,"./ja.js":484,"./jv":485,"./jv.js":485,"./ka":486,"./ka.js":486,"./kk":487,"./kk.js":487,"./km":488,"./km.js":488,"./kn":489,"./kn.js":489,"./ko":490,"./ko.js":490,"./ku":491,"./ku.js":491,"./ky":492,"./ky.js":492,"./lb":493,"./lb.js":493,"./lo":494,"./lo.js":494,"./lt":495,"./lt.js":495,"./lv":496,"./lv.js":496,"./me":497,"./me.js":497,"./mi":498,"./mi.js":498,"./mk":499,"./mk.js":499,"./ml":500,"./ml.js":500,"./mn":501,"./mn.js":501,"./mr":502,"./mr.js":502,"./ms":503,"./ms-my":504,"./ms-my.js":504,"./ms.js":503,"./mt":505,"./mt.js":505,"./my":506,"./my.js":506,"./nb":507,"./nb.js":507,"./ne":508,"./ne.js":508,"./nl":509,"./nl-be":510,"./nl-be.js":510,"./nl.js":509,"./nn":511,"./nn.js":511,"./oc-lnc":512,"./oc-lnc.js":512,"./pa-in":513,"./pa-in.js":513,"./pl":514,"./pl.js":514,"./pt":515,"./pt-br":516,"./pt-br.js":516,"./pt.js":515,"./ro":517,"./ro.js":517,"./ru":518,"./ru.js":518,"./sd":519,"./sd.js":519,"./se":520,"./se.js":520,"./si":521,"./si.js":521,"./sk":522,"./sk.js":522,"./sl":523,"./sl.js":523,"./sq":524,"./sq.js":524,"./sr":525,"./sr-cyrl":526,"./sr-cyrl.js":526,"./sr.js":525,"./ss":527,"./ss.js":527,"./sv":528,"./sv.js":528,"./sw":529,"./sw.js":529,"./ta":530,"./ta.js":530,"./te":531,"./te.js":531,"./tet":532,"./tet.js":532,"./tg":533,"./tg.js":533,"./th":534,"./th.js":534,"./tl-ph":535,"./tl-ph.js":535,"./tlh":536,"./tlh.js":536,"./tr":537,"./tr.js":537,"./tzl":538,"./tzl.js":538,"./tzm":539,"./tzm-latn":540,"./tzm-latn.js":540,"./tzm.js":539,"./ug-cn":541,"./ug-cn.js":541,"./uk":542,"./uk.js":542,"./ur":543,"./ur.js":543,"./uz":544,"./uz-latn":545,"./uz-latn.js":545,"./uz.js":544,"./vi":546,"./vi.js":546,"./x-pseudo":547,"./x-pseudo.js":547,"./yo":548,"./yo.js":548,"./zh-cn":549,"./zh-cn.js":549,"./zh-hk":550,"./zh-hk.js":550,"./zh-mo":551,"./zh-mo.js":551,"./zh-tw":552,"./zh-tw.js":552};function j(s){var e=a(s);return t(e)}function a(s){if(!t.o(n,s)){var e=new Error("Cannot find module '"+s+"'");throw e.code="MODULE_NOT_FOUND",e}return n[s]}j.keys=function(){return Object.keys(n)},j.resolve=a,s.exports=j,j.id=636}}]);
//# sourceMappingURL=tvmaze-view-calendar-cd469bd3180ed10514fb.js.map