(self.webpackJsonp=self.webpackJsonp||[]).push([[44],{690:function(e,t){},691:function(e,t){},701:function(e,t){},702:function(e,t){},722:function(e,t){},724:function(e,t){},725:function(e,t){},726:function(e,t){},727:function(e,t){},734:function(e,t){},737:function(e,t){},743:function(e,t){},746:function(e,t){},948:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,i,u,a,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(1),f=n(3),d=v(n(6)),p=v(n(581)),b=v(n(949)),h=v(n(951));function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}u=c.Radio.channel("global"),s=c.Radio.channel("messages"),o=u.request("main:app:AuthModel"),i=function(){var e=function(e){function t(){return y(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,e),t}(o);return e.prototype.url="/api/dev/dbadmin/export-models",e}.call(void 0),r=function(){var e=function(e){function t(){return y(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,e),t}(o);return e.prototype.url="/api/dev/dbadmin/delete-models",e}.call(void 0),a=function(){var e=function(e){function t(){return y(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,e),l(t,[{key:"onRender",value:function(){var e;return e=new b.default,this.showChildView("dropFile",e)}},{key:"deleteBtnClicked",value:function(){var e;return console.log("deleteBtnClicked"),(e=new r).fetch().done((function(){return s.request("success",e.get("result"))}))}},{key:"listBtnClicked",value:function(){return c.history.navigate("#dbadmin/models",{trigger:!0})}},{key:"exportDatabase",value:function(){var e,t=this;return this.ui.statusMsg.text("Exporting database..."),(e=new i).fetch().done((function(){var n;return n=(0,h.default)(e),p.default.saveAs(n.blob,n.filename),s.request("success","Exported database...."),t.ui.statusMsg.text("sha256: "+e.get("sha256sum"))}))}}]),t}(f.View);return e.prototype.template=d.default.renderable((function(){return d.default.div(".row.listview-header",(function(){return d.default.text("Garkbit Dbadmin")})),d.default.div(".row",(function(){return d.default.div(".col",(function(){return d.default.button(".delete-btn.btn.btn-danger","Delete"),d.default.button(".exportdb-btn.btn.btn-info","Export"),d.default.button(".list-btn.btn.btn-primary","List")}))})),d.default.div(".row",(function(){return d.default.div(".col",(function(){return d.default.div(".listview-header","User Locations"),d.default.div(".list-container")})),d.default.div(".col",(function(){return d.default.div(".row.status-message"),d.default.div(".row.dropfile-view")}))}))})),e.prototype.ui={exportBtn:".exportdb-btn",deleteBtn:".delete-btn",listBtn:".list-btn",statusMsg:".status-message",dropFile:".dropfile-view",listContainer:".list-container"},e.prototype.regions={dropFile:"@ui.dropFile",listContainer:"@ui.listContainer"},e.prototype.events={"click @ui.exportBtn":"exportDatabase","click @ui.deleteBtn":"deleteBtnClicked","click @ui.listBtn":"listBtnClicked"},e}.call(void 0),t.default=a},949:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(1),u=n(950),a=(o=u)&&o.__esModule?o:{default:o};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f,d,p,b,h,v=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};b=i.Radio.channel("global"),h=i.Radio.channel("messages"),f=b.request("main:app:AuthModel"),p=function(){var e=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,e),t}(f);return e.prototype.url="/api/dev/dbadmin/import-models",e}.call(void 0),d=function(){var e=function(e){function t(){s(this,t);var e=l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.successfulParse=e.successfulParse.bind(e),e.fileReaderOnLoad=e.fileReaderOnLoad.bind(e),e}return c(t,e),r(t,[{key:"successfulParse",value:function(){return v(this,t),this.ui.statusMsg.text("Parse Successful"),h.request("success","successfulParse")}},{key:"fileReaderOnLoad",value:function(e){var n,o,r,i,u=this;return v(this,t),n=e.target.result,o=e.target.fileObject.name,this.ui.statusMsg.text("Retrieved file content of "+o),i=(r=new p({content:btoa(n)})).save(),this.ui.statusMsg.text("Uploaded "+o+"."),i.fail((function(){return h.request("warning","failed to save model")})),i.done((function(){return console.log("MODEL",r),h.request("success","Finished import"),u.ui.statusMsg.text("Finished import")}))}}]),t}(a.default);return e.prototype.parseMsg="Parse the file",e.prototype.headerMsg="drop a dump of the database to upload",e.prototype.inputId="dbdump-input",e}.call(void 0),t.default=d},951:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n,i,u,a,s,l;return i=e.get("sha256sum"),u=e.get("content"),"production",s={filename:"dbdump-production-"+i.slice(0,5)+".json.xz",type:"application/octet-stream",data:u},t=(0,o.default)(s.data,s.type),n=atob(u),console.log("BLOB",t),console.log("size",t.size,n.length,u.length),a=r.default.hash.sha256.hash,l=(0,r.default.codec.hex.fromBits)(a(n)),console.log("Result",l),console.log("cksum",i),s.blob=t,s};var o=i(n(667)),r=i(n(952));function i(e){return e&&e.__esModule?e:{default:e}}}}]);
//# sourceMappingURL=dbadmin-view-index-9113adf5c7f30cac0fbd.js.map