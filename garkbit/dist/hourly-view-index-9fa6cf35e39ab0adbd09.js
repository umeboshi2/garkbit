(self.webpackJsonp=self.webpackJsonp||[]).push([[47],{466:function(e,t,n){"use strict";var o=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u,i,l,a,s,c,f,p,d=v(n(1)),h=v(n(2)),y=v(n(3)),w=(v(n(32)),v(n(5)),v(n(467)));function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}d.default.Radio.channel("global"),l=d.default.Radio.channel("messages"),u=d.default.Radio.channel("hourly"),p=y.default.renderable(function(e){return y.default.div(".row.status")}),c=y.default.renderable(function(e){return y.default.div(".row.listview-list-entry",function(){return y.default.text("You are not a worker.")})}),a=function(){var e=(m(t,h.default.View),t);function t(){return b(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=c,e}.call(void 0),f=y.default.renderable(function(e){var t;return y.default.div(".row.listview-list-entry",function(){return y.default.text(e.user.fullname+" is a worker.")}),y.default.div(".row.listview-list-entry.work-session"),t={action:"in",btnClass:".clock-btn.btn.btn-info.fa.fa-clock-o"},"in",null===e.status&&y.default.div(".row.listview-list-entry",function(){return y.default.text(e.user.fullname+" has never clocked in.")}),"on"===e.status&&(t.action="out",t.btnClass=".clock-btn.btn.btn-warning.fa.fa-clock-o"),y.default.div(".row",function(){return y.default.button(t.btnClass,function(){return y.default.text("Clock "+t.action)})})}),s=function(){var e=(m(t,h.default.View),o(t,[{key:"ui",value:function(){return{clockBtn:".clock-btn",workSessionRegion:".work-session"}}},{key:"events",value:function(){return{"click @ui.clockBtn":"punchClock"}}},{key:"punchClock",value:function(){var e,t;return t=this.model,e=this.model.get("status"),console.log("punchClock",t,e),"off"===e||null===e?this.punchIn():"on"===e?this.punchOut():l.request("warning","Bad worker status "+e)}},{key:"punchIn",value:function(){var e,t,n=this;return this.model.get("id"),e=new w.default,(t=e.save(null,{type:"POST",url:e.urlRoot})).done(function(){return n.clockUserIn()}),t.fail(function(){return l.request("warning",t.responseJSON.code)})}},{key:"punchOut",value:function(){var t,e,n=this;return e=this.model.get("id"),(t=new w.default({worker_id:e})).fetch().done(function(){var e;return(e=t.save()).done(function(){return n.clockUserOut()}),e.fail(function(){return l.request("warning",e.responseJSON.code)})})}},{key:"clockUserOut",value:function(){return this.model.set("status","off"),console.log("@clockUserOut",this.model),this.render()}},{key:"clockUserIn",value:function(){return this.model.set("status","on"),console.log("@clockUserIn",this.model),this.render()}},{key:"insertNewStatus",value:function(){var e;return e=this.model,new(u.request("status-modelClass"))({worker_id:e.get("id")}),response}}]),t);function t(){return b(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=f,e.prototype.regions={workSessionRegion:"@ui.workSessionRegion"},e}.call(void 0),i=function(){var e=(m(t,h.default.View),o(t,[{key:"ui",value:function(){return{status:".status"}}},{key:"onRender",value:function(){var e,t=this;return console.log("MODEL IS",this.model),(e=this.model.fetch()).done(function(){var e;return e=new s({model:t.model}),t.showChildView("status",e)}),e.fail(function(){var e;return e=new a({model:t.model}),t.showChildView("status",e)})}}]),t);function t(){return b(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=p,e.prototype.regions={status:"@ui.status"},e.prototype.templateContext={appName:"hourly"},e}.call(void 0),e.exports=i},467:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,u,i,l=n(1),a=(o=l)&&o.__esModule?o:{default:o};n(122);u=a.default.Radio.channel("global"),a.default.Radio.channel("hourly"),r=u.request("main:app:AuthModel"),u.request("main:app:AuthCollection"),i=function(){var e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r),t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.urlRoot="/api/dev/hourly/time-clock",e}.call(void 0),t.default=i}}]);
//# sourceMappingURL=hourly-view-index-9fa6cf35e39ab0adbd09.js.map