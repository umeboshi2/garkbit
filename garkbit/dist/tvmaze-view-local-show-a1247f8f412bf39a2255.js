(self.webpackJsonp=self.webpackJsonp||[]).push([[91],{572:function(e,t,o){"use strict";var r,n,i,s,a,u,c,l,d,p=function(e,t,o){return t&&f(e.prototype,t),o&&f(e,o),e};function f(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}o(4),n=o(1),a=o(2),d=o(3),o(34),s=o(88),o(89),o(35).default,o(5).navigate_to_url,o(33).form_group_input_div,l=o(86).default,i=o(573),u=n.Radio.channel("messages"),r=n.Radio.channel("tvmaze"),c=function(){var e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.View),p(t,[{key:"onDomRefresh",value:function(){var e;return this.jsonView=new s(this.model.toJSON().content),this.ui.body.prepend(this.jsonView.dom),e=r.request("get-local-episode-collection"),this.localEpisodes=new e,this.showLocalEpisodes()}},{key:"showLocalEpisodes",value:function(){var o=this;return this.localEpisodes.fetch({data:{show_id:this.model.get("id")}}).done(function(){var e,t;return o.localEpisodes.isEmpty()?(u.request("info","Retrieving episodes..."),(e=r.request("get-remote-episodes",o.model.id)).fetch().done(function(){return o.saveEpisodes(e)})):(t=new i({collection:o.localEpisodes}),o.showChildView("episodes",t))})}},{key:"saveEpisodes",value:function(e){var n,i,t=this;return i=this.model.get("id"),n=[],e.models.forEach(function(e){var t,o;return t={id:e.get("id"),show_id:i,content:e.toJSON()},o=r.request("save-local-episode",t),n.push(o)}),Promise.all(n).then(function(e){return n.length&&t.showLocalEpisodes(),u.request("success","Retrieved "+n.length+" episodes.")})}}]),t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=d.renderable(function(t){var o;return o=t.content,d.div(".card.bg-body-d5",function(){return d.div(".row",function(){return d.div(".col-md-2",function(){var e;return(null!=(e=o.image)?e.medium:void 0)?d.img(".card-img-bottom",{src:t.content.image.medium}):l("5x")}),d.div(".col-md-9",function(){return d.div(".card-block",function(){return d.h3(".card-title",t.content.name),d.raw(t.content.summary)})})}),d.div(".row",function(){return d.div(".col-md-8",function(){return d.div(".episode-list-region")}),d.div(".col-md-4",function(){return d.div(".listview-header","ShowObject"),d.div(".jsonview.listview-list-entry",{style:"overflow:auto"})})})})}),e.prototype.ui={body:".jsonview",episodesButton:".episodes-button",saveEpisodesButton:".save-episodes",episodesList:".episode-list-region"},e.prototype.regions={episodes:"@ui.episodesList"},e}.call(void 0),e.exports=c},573:function(e,t,o){"use strict";var n,i,r,s,a,u,c,l=function(e,t,o){return t&&d(e.prototype,t),o&&d(e,o),e};function d(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n=o(1),a=o(2),c=o(3),s=o(88),o(89),o(5).navigate_to_url,o(33).form_group_input_div,o(86).default,n.Radio.channel("messages"),n.Radio.channel("tvmaze"),u=c.renderable(function(e){return c.div(".card.bg-body-d10",function(){return c.div(".card-header",function(){return e.summary||e.img_med?c.span(".text-local-secondary",{href:"#"},e.name):c.span(".text-light",e.name),c.span(".bg-body-d5.pull-right",function(){return e.season&&(c.span("Season "+e.season),c.raw("&nbsp;&nbsp;&nbsp;")),c.span(".bg-body-d10",e.airdate.toDateString())})}),c.div(".card-block",function(){return c.div(".summary.row",{style:"display:none"},function(){return(null!=e?e.img_med:void 0)?(c.div(".col-md-7",function(){return c.raw(e.summary)}),c.div(".col-md-5",function(){return c.img(".card-img-bottom.pull-right",{src:e.img_med})})):c.div(".col-md-12",function(){return c.raw(e.summary)})}),c.div(".jsonview")})})}),r=function(){var e=(m(t,a.View),l(t,[{key:"canShowSummary",value:function(){var e,t;return t=this.model.get("summary"),e=this.model.get("img_med"),t||e}},{key:"showEpisodeSummary",value:function(e){if(e.preventDefault(),this.canShowSummary())return this.ui.summary.toggle()}},{key:"onDomRefreshJsonVIew",value:function(){return this.jsonview=new s(this.model.toJSON()),this.ui.objectContainer.prepend(this.jsonview.dom)}},{key:"handleHover",value:function(){if(this.canShowSummary())return this.$el.css({cursor:"pointer"})}}]),t);function t(){return p(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=u,e.prototype.ui={summary:".summary",objectContainer:".jsonview"},e.prototype.regions={summary:"@ui.summary",objectContainer:"@ui.objectContainer"},e.prototype.events={click:"showEpisodeSummary",mouseenter:"handleHover"},e}.call(void 0),i=function(){var e=(m(t,a.View),l(t,[{key:"onRender",value:function(){var e;return e=new a.CollectionView({collection:this.collection,childView:r}),this.showChildView("itemList",e)}}]),t);function t(){return p(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return e.prototype.template=c.renderable(function(e){return c.div(".listview-header",function(){return c.text("Episodes")}),c.div(".episode-list")}),e.prototype.ui={header:".listview-header",itemList:".episode-list"},e.prototype.regions={itemList:"@ui.itemList"},e}.call(void 0),e.exports=i},86:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=o(3),r=(n=i)&&n.__esModule?n:{default:n};t.default=r.default.renderable(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"5x";return r.default.span(".fa-stack.fa-"+e,function(){return r.default.i(".fa.fa-image.fa-stack-1x"),r.default.i(".fa.fa-ban.fa-stack-2x.text-danger")})})}}]);
//# sourceMappingURL=tvmaze-view-local-show-a1247f8f412bf39a2255.js.map