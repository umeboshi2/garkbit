(self.webpackJsonp=self.webpackJsonp||[]).push([[72],{464:function(e,s,t){var n={"./af":313,"./af.js":313,"./ar":314,"./ar-dz":315,"./ar-dz.js":315,"./ar-kw":316,"./ar-kw.js":316,"./ar-ly":317,"./ar-ly.js":317,"./ar-ma":318,"./ar-ma.js":318,"./ar-sa":319,"./ar-sa.js":319,"./ar-tn":320,"./ar-tn.js":320,"./ar.js":314,"./az":321,"./az.js":321,"./be":322,"./be.js":322,"./bg":323,"./bg.js":323,"./bm":324,"./bm.js":324,"./bn":325,"./bn-bd":326,"./bn-bd.js":326,"./bn.js":325,"./bo":327,"./bo.js":327,"./br":328,"./br.js":328,"./bs":329,"./bs.js":329,"./ca":330,"./ca.js":330,"./cs":331,"./cs.js":331,"./cv":332,"./cv.js":332,"./cy":333,"./cy.js":333,"./da":334,"./da.js":334,"./de":335,"./de-at":336,"./de-at.js":336,"./de-ch":337,"./de-ch.js":337,"./de.js":335,"./dv":338,"./dv.js":338,"./el":339,"./el.js":339,"./en-au":340,"./en-au.js":340,"./en-ca":341,"./en-ca.js":341,"./en-gb":342,"./en-gb.js":342,"./en-ie":343,"./en-ie.js":343,"./en-il":344,"./en-il.js":344,"./en-in":345,"./en-in.js":345,"./en-nz":346,"./en-nz.js":346,"./en-sg":347,"./en-sg.js":347,"./eo":348,"./eo.js":348,"./es":349,"./es-do":350,"./es-do.js":350,"./es-mx":351,"./es-mx.js":351,"./es-us":352,"./es-us.js":352,"./es.js":349,"./et":353,"./et.js":353,"./eu":354,"./eu.js":354,"./fa":355,"./fa.js":355,"./fi":356,"./fi.js":356,"./fil":357,"./fil.js":357,"./fo":358,"./fo.js":358,"./fr":359,"./fr-ca":360,"./fr-ca.js":360,"./fr-ch":361,"./fr-ch.js":361,"./fr.js":359,"./fy":362,"./fy.js":362,"./ga":363,"./ga.js":363,"./gd":364,"./gd.js":364,"./gl":365,"./gl.js":365,"./gom-deva":366,"./gom-deva.js":366,"./gom-latn":367,"./gom-latn.js":367,"./gu":368,"./gu.js":368,"./he":369,"./he.js":369,"./hi":370,"./hi.js":370,"./hr":371,"./hr.js":371,"./hu":372,"./hu.js":372,"./hy-am":373,"./hy-am.js":373,"./id":374,"./id.js":374,"./is":375,"./is.js":375,"./it":376,"./it-ch":377,"./it-ch.js":377,"./it.js":376,"./ja":378,"./ja.js":378,"./jv":379,"./jv.js":379,"./ka":380,"./ka.js":380,"./kk":381,"./kk.js":381,"./km":382,"./km.js":382,"./kn":383,"./kn.js":383,"./ko":384,"./ko.js":384,"./ku":385,"./ku.js":385,"./ky":386,"./ky.js":386,"./lb":387,"./lb.js":387,"./lo":388,"./lo.js":388,"./lt":389,"./lt.js":389,"./lv":390,"./lv.js":390,"./me":391,"./me.js":391,"./mi":392,"./mi.js":392,"./mk":393,"./mk.js":393,"./ml":394,"./ml.js":394,"./mn":395,"./mn.js":395,"./mr":396,"./mr.js":396,"./ms":397,"./ms-my":398,"./ms-my.js":398,"./ms.js":397,"./mt":399,"./mt.js":399,"./my":400,"./my.js":400,"./nb":401,"./nb.js":401,"./ne":402,"./ne.js":402,"./nl":403,"./nl-be":404,"./nl-be.js":404,"./nl.js":403,"./nn":405,"./nn.js":405,"./oc-lnc":406,"./oc-lnc.js":406,"./pa-in":407,"./pa-in.js":407,"./pl":408,"./pl.js":408,"./pt":409,"./pt-br":410,"./pt-br.js":410,"./pt.js":409,"./ro":411,"./ro.js":411,"./ru":412,"./ru.js":412,"./sd":413,"./sd.js":413,"./se":414,"./se.js":414,"./si":415,"./si.js":415,"./sk":416,"./sk.js":416,"./sl":417,"./sl.js":417,"./sq":418,"./sq.js":418,"./sr":419,"./sr-cyrl":420,"./sr-cyrl.js":420,"./sr.js":419,"./ss":421,"./ss.js":421,"./sv":422,"./sv.js":422,"./sw":423,"./sw.js":423,"./ta":424,"./ta.js":424,"./te":425,"./te.js":425,"./tet":426,"./tet.js":426,"./tg":427,"./tg.js":427,"./th":428,"./th.js":428,"./tk":429,"./tk.js":429,"./tl-ph":430,"./tl-ph.js":430,"./tlh":431,"./tlh.js":431,"./tr":432,"./tr.js":432,"./tzl":433,"./tzl.js":433,"./tzm":434,"./tzm-latn":435,"./tzm-latn.js":435,"./tzm.js":434,"./ug-cn":436,"./ug-cn.js":436,"./uk":437,"./uk.js":437,"./ur":438,"./ur.js":438,"./uz":439,"./uz-latn":440,"./uz-latn.js":440,"./uz.js":439,"./vi":441,"./vi.js":441,"./x-pseudo":442,"./x-pseudo.js":442,"./yo":443,"./yo.js":443,"./zh-cn":444,"./zh-cn.js":444,"./zh-hk":445,"./zh-hk.js":445,"./zh-mo":446,"./zh-mo.js":446,"./zh-tw":447,"./zh-tw.js":447};function r(e){var s=a(e);return t(s)}function a(e){if(!t.o(n,e)){var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=a,e.exports=r,r.id=464},951:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var n=function(){function e(e,s){for(var t=0;t<s.length;t++){var n=s[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(s,t,n){return t&&e(s.prototype,t),n&&e(s,n),s}}(),r=u(t(27)),a=t(1),o=t(4),i=u(t(7)),l=u(t(95)),j=u(t(295));function u(e){return e&&e.__esModule?e:{default:e}}t(533),t(534);var c,d,f,h,m,p,b;f=a.Radio.channel("global"),c=a.Radio.channel("tvmaze"),h=i.default.renderable((function(){return i.default.div(".listview-header","Episodes"),i.default.div(".loading",(function(){return i.default.h2((function(){return i.default.i(".fa.fa-spinner.fa-spin"),i.default.text("Loading Episodes")}))})),i.default.div(".maincalendar")})),b=function(e,s){return e.url="#tvmaze/shows/view/"+e.showId,s.css({cursor:"pointer","font-size":"0.9em","font-family":"Rambla"})},p=function(e){var s,t;return t=(0,r.default)(".loading"),s=(0,r.default)(".fc-toolbar"),e?(t.show(),s.hide()):(t.hide(),s.show())},m=function(e,s,t,n){var r,o,i,u,c,d;return d=(r=f.request("main:app:dbConn","tvmaze")).getSchema().table("TVMazeEpisode"),i=[],window.startMoment=e,c=e.toDate(),o=s.toDate(),i.push(d.airdate.gte(e)),i.push(d.airdate.lte(s)),u=r.select().from(d).where(l.default.op.and(d.airdate.gte(e.toDate()),d.airdate.lte(s.toDate()))),console.log("Q",u,c,o),u=u.exec(),console.log("Q",u),u.then((function(e){var s,t,r;return console.log("RESULTS",e),(s=new a.Collection).set(e),t=s.toJSON(),console.log("collection",s),r=[],t.forEach((function(e){var s,t,n;return s=(0,j.default)(e.airdate),n=e.runtime||30,t={id:e.id,showId:e.show_id,title:e.name,allDay:!1,start:s,end:s.add(n,"minutes"),url:"#tvmaze/shows/view/"+e.show_id},r.push(t)})),n(r)}))},d=function(){var e=function(e){function s(){!function(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this,s);var e=function(e,s){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!s||"object"!=typeof s&&"function"!=typeof s?e:s}(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments));return e.calendarViewRender=e.calendarViewRender.bind(e),e}return function(e,s){if("function"!=typeof s&&null!==s)throw new TypeError("Super expression must either be null or a function, not "+typeof s);e.prototype=Object.create(s&&s.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),s&&(Object.setPrototypeOf?Object.setPrototypeOf(e,s):e.__proto__=s)}(s,e),n(s,[{key:"onBeforeDestroy",value:function(){this.ui.calendar.fullCalendar("destroy")}},{key:"calendarViewRender",value:function(e,t){return function(e,s){if(!(e instanceof s))throw new Error("Bound instance method accessed before binding")}(this,s),c.request("maincalendar:set-date",this.ui.calendar)}},{key:"onDomRefresh",value:function(){var e,s,t=this;return e=function(e){var s,n;return t.options.minicalendar?(s={layout:t.options.layout,region:"episode",id:e.id},c.request("view-episode",s)):(n=e.url,console.log("EVENT URL",e,n),a.history.navigate(n,{trigger:!0}))},s=c.request("maincalendar:get-date"),this.ui.calendar.fullCalendar({defaultDate:s,header:{left:"prevYear, nextYear",center:"title",right:"prev, next"},theme:!1,defaultView:"month",eventSources:[{events:m}],eventRender:b,viewRender:this.calendarViewRender,loading:p,eventClick:e}),console.log("we should either be fetching events, or refetching")}}]),s}(o.View);return e.prototype.template=h,e.prototype.ui={calendar:".maincalendar",loading:".loading",header:".fc-toolbar",daytop:".fc-day-top"},e.prototype.options={minicalendar:!1,layout:!1},e}.call(void 0),s.default=d}}]);
//# sourceMappingURL=tvmaze-view-calendar-9f1ad26b31f4fa38f12b.js.map