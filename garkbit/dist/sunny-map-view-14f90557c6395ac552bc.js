(self.webpackJsonp=self.webpackJsonp||[]).push([[66],{208:function(e,t){L.Icon.Glyph=L.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41],className:"",prefix:"",glyph:"home",glyphColor:"white",glyphSize:"11px",glyphAnchor:[0,-7]},createIcon:function(){var e=document.createElement("div"),t=this.options;return t.glyph&&e.appendChild(this._createGlyph()),this._setIconStyles(e,t.className),e},_createGlyph:function(){var e,t,o=this.options;o.prefix?e="fab"===o.prefix||"fal"===o.prefix||"far"===o.prefix||"fas"===o.prefix?"fa-"+o.glyph:o.glyph.slice(0,o.prefix.length+1)===o.prefix+"-"?o.glyph:o.prefix+"-"+o.glyph:(e="",t=o.glyph);var i=L.DomUtil.create("span",o.prefix+" "+e);return i.style.fontSize=o.glyphSize,i.style.color=o.glyphColor,i.style.width=o.iconSize[0]+"px",i.style.lineHeight=o.iconSize[1]+"px",i.style.textAlign="center",i.style.marginLeft=o.glyphAnchor[0]+"px",i.style.marginTop=o.glyphAnchor[1]+"px",i.style.pointerEvents="none",t&&(i.innerHTML=t,i.style.display="inline-block"),i},_setIconStyles:function(e,t){if("shadow"===t)return L.Icon.prototype._setIconStyles.call(this,e,t);var o=this.options,i=L.point(o.iconSize),n=L.point(o.iconAnchor);!n&&i&&(n=i.divideBy(2,!0)),e.className="leaflet-marker-icon leaflet-glyph-icon "+t;var r=this._getIconUrl("icon");r&&(e.style.backgroundImage="url('"+r+"')"),o.bgPos&&(e.style.backgroundPosition=-o.bgPos.x+"px "+-o.bgPos.y+"px"),o.bgSize&&(e.style.backgroundSize=o.bgSize.x+"px "+o.bgSize.y+"px"),n&&(e.style.marginLeft=-n.x+"px",e.style.marginTop=-n.y+"px"),i&&(e.style.width=i.x+"px",e.style.height=i.y+"px")}}),L.icon.glyph=function(e){return new L.Icon.Glyph(e)},L.Icon.Glyph.prototype.options.iconUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAUlSURBVFjDrZdLiBxVFIb/e289uqt6kkx6zIiIoKgLRReKuMhCcaOIAUEIiCCE4CIPggZ8kBjooPgM0TiYEUUjqBGchZqAQlyYRTA+kJiJQiJGMjN5zYzT3dP1rrr3HBeTjDGTSfc8Dvyruud89Z9z6kIJdBj31763MivsJXKuZYF6dak5++2mh7NOcsXVHq6sHbhOK/24kOJJMO4AE1vKygwZhxlKSHGKiD+RSu09vOXB43OCrHz96y6T2lsh+OmKXzFdlbLne2UopSAupBhjECcZgjDMgiiSxPhcK/nCr1sfOtcWcm/tq9uEsL4rl0vdK67pKVu2jUwTMk0wBBAzpBCQAnAtiZIlwWQwPlHPglZQAFj1Y23VwVkh92zbd59U+Kanp+p2L12mooKQ5AbcpuclS6LiKoRhxOfHzhXMcs3PtVV7Z0DufXH/LSzpSG9vr1/p6kIz0dDUrvx/IYXAsrJCkWc4e/Z0Zpgf+KX26A/TkNtrXziesY9Xq8tvWNZdVfVYg7hzwKVv3O3ZiKMWj46OTrq5fdOh1x5pSADwjdzo2nbv0u6qqkca2jCIMGcZAuqRhu8vEX7ZK2V2WgMAcXdtvyeKbPS662+osCohzMycHVweniNREoShoZO5KYobpciSh23bFq7rIUgNiLFghRkBlg2v7GlpiccsCHrcryzxUk3zmsNskeYGvt/lxVH4hMWEu9xSWaQFYQ7L1B6iGZ5bBoy+zWKiHiltFHpqeIsVhWaosg1iqlgg4wAAEYEXsV3EmNppJmExMFYUxfVSuIs6E0sI5FkBBhLJzH9laQxLSjBj0WQJgSJPweDTkknvS4JGbCuxKOt7UY4lEQfNnAu9TzLxN2nUdAQTLAEw8YIlAVgAkmDCSBL75eCutSeY+GTUqqNkqUVxUbIl4qgJo4vWzecrhyQAMJldYf1MXLLl1EIsYBZgoGwpRI2zMTPtGBhYbSQAlJF9lieRzNMIriVBzPOWawvoIkYaNC0u9IcAIAHgp75NLQl8ENbPZJ6jgAU48RyFqHEuZyE+Pda/vjENAQBD5s209Y+kPJlyM4+r3lUS0AWSyVEhpHnjYu1pyO+7N4ywwPvhxHDiuwo8j1b5rkQwMZIziYHBXetPzIAAgIV8exZOSMoieI6aU5vKtgR0jqw1JtiYbZfW/R/kSN+mcWbxdtwYjn1XTd9B7cQAfNdCWB/OhBR7jvWv/3tWCAAoO3ktjyZZJ0HHbsq2AooERVQXzPKly2vOgPz29jNNBr+e1IcSz5YAM4hmFzPDtyWS+lDK4N2DfU+dbgsBAFHyd+oszE3agt/GjWcrUBEjj5sQBb96pXpXhAzueDJi4u1p41TsuQpCiFln4bkKeXMoJeadg++tG+sYAgBBXOo3RRrruAnfkWDmGfIdCeQhiiQgQbxjtlqzQk59vCZlNluL5lDiORLyMjcA4DsKeXM4AfDKxa97ThAAqPaMfaR1Nq6jOiqOAhOm5TsKJg1QZGGRedY7V6tzVcjBWk1D0JZ8cigt2RJSimkXnqOgW8MxQLUTb6wN5g0BgGPV0c9BekTH41xx5YXrQ8FkTRgdpxU7ea9djbYQ1GokmJ43wUhWtgRcS04tQjAcw9CWw29tThYOAXD03XVfMps/TTTOy30blDZgiqxFK6p7OsnvCDJ1UD9LyUjORoPDkUQyPfdHbXW+qJCjfRsOwOAoNY4z6Xz01rHq3k5zO4ZMHTabYSIhJD87MLB64f8Ys8WdG/tfBljMJedfwY+s/2P4Pv8AAAAASUVORK5CYII="},631:function(e,t,o){"use strict";var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),n=s(o(1)),r=o(2),l=s(o(3)),a=(s(o(8)),s(o(110)));o(208);var c=s(o(5));s(o(632));function s(e){return e&&e.__esModule?e:{default:e}}var p,u,h,A,d,f=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};o(129),h=n.default.Radio.channel("global"),p=n.default.Radio.channel("sunny"),u=n.default.Radio.channel("gps"),h.request("main:app:AuthModel"),h.request("main:app:AuthCollection"),d=l.default.renderable(function(e){return l.default.div(".row",function(){return l.default.h2("Map View"),l.default.div(".checkbox",function(){return l.default.label(function(){return l.default.input("#watch-map",{type:"checkbox"}),l.default.text("watch")})})}),l.default.div(".row",function(){return l.default.div("#map-view.col-md-4",{style:"height:20em;"})})}),A=function(){var e=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getCenter=e.getCenter.bind(e),e.onLocationError=e.onLocationError.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.View),i(t,[{key:"watch_button",value:function(e){return console.log("somwthing happened",e),e.target.checked?(console.log("Watch me!!!!",this.ui.map),this.Map.locate({watch:!0})):(console.log("Stop watching me....",this.ui.map),this.Map.locate({watch:!1}))}},{key:"addYardMarkers",value:function(){var e,t=this;return(e=p.request("db:yard:collection")).fetch({data:{limit:50}}).done(function(){var o,i,n,r,l;for(console.log("YARDS",e),l=[],o=0,i=(r=e.models).length;o<i;o++)n=r[o],l.push(function(e){var o,i,n;if((o=e.attributes.location).latitude)return i=[o.latitude,o.longitude],(n=a.default.marker(i,{icon:a.default.icon.glyph({prefix:"fa",glyph:"circle"}),url:"#sunny/yards/view/"+o.id,title:e.attributes.name})).on("click",function(){return(0,c.default)("#sunny/yards/view/"+e.id)}),n.addTo(t.Map)}(n));return l})}},{key:"addPositionMarkers",value:function(){var e,t=this;return(e=u.request("position-collection")).fetch().done(function(){var o,i,n,r,l,c,s;for(s=[],i=0,n=(c=e.models).length;i<n;i++)(o=c[i].attributes).latitude?(r=[o.latitude,o.longitude],l=a.default.marker(r,{icon:a.default.icon.glyph({prefix:"fa",glyph:"circle"}),url:"#sunny/yards/view/"+o.id}),console.log("marker location",r,o.id),s.push(l.addTo(t.Map))):s.push(void 0);return s})}},{key:"onDomRefresh",value:function(){var e;return this.Map=a.default.map("map-view"),13,[31.33,-89.28],this.Map.on("moveend",this.getCenter),this.Map.on("locationerror",this.onLocationError),this.Map.locate({setView:!0,watch:!1,enableHighAccuracy:!0}),(e=a.default.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png")).addTo(this.Map),console.log("MAP, LAYER",this.Map,e),this.addYardMarkers()}},{key:"getCenter",value:function(e){return f(this,t),console.log(this.Map.getCenter())}},{key:"onLocationError",value:function(e){var o;if(f(this,t),console.log("unable to get location",e),!this.first_location_error)return console.log("initialize map location"),o=[31.33,-89.28],this.Map.setView(o,13),this.first_location_error=!0}}]),t}();return e.prototype.template=d,e.prototype.ui={map:"#map-view",watch:"#watch-map"},e.prototype.events={"change @ui.watch":"watch_button"},e.prototype.defaultMapStyle="height:20em;",e.prototype.fsMapStyle="position: absolute; top: 0; right: 0; bottom: 0; left: 0;",e.prototype.first_location_error=!1,e}.call(void 0),e.exports=A},632:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAUlSURBVFjDrZdLiBxVFIb/e289uqt6kkx6zIiIoKgLRReKuMhCcaOIAUEIiCCE4CIPggZ8kBjooPgM0TiYEUUjqBGchZqAQlyYRTA+kJiJQiJGMjN5zYzT3dP1rrr3HBeTjDGTSfc8Dvyruud89Z9z6kIJdBj31763MivsJXKuZYF6dak5++2mh7NOcsXVHq6sHbhOK/24kOJJMO4AE1vKygwZhxlKSHGKiD+RSu09vOXB43OCrHz96y6T2lsh+OmKXzFdlbLne2UopSAupBhjECcZgjDMgiiSxPhcK/nCr1sfOtcWcm/tq9uEsL4rl0vdK67pKVu2jUwTMk0wBBAzpBCQAnAtiZIlwWQwPlHPglZQAFj1Y23VwVkh92zbd59U+Kanp+p2L12mooKQ5AbcpuclS6LiKoRhxOfHzhXMcs3PtVV7Z0DufXH/LSzpSG9vr1/p6kIz0dDUrvx/IYXAsrJCkWc4e/Z0Zpgf+KX26A/TkNtrXziesY9Xq8tvWNZdVfVYg7hzwKVv3O3ZiKMWj46OTrq5fdOh1x5pSADwjdzo2nbv0u6qqkca2jCIMGcZAuqRhu8vEX7ZK2V2WgMAcXdtvyeKbPS662+osCohzMycHVweniNREoShoZO5KYobpciSh23bFq7rIUgNiLFghRkBlg2v7GlpiccsCHrcryzxUk3zmsNskeYGvt/lxVH4hMWEu9xSWaQFYQ7L1B6iGZ5bBoy+zWKiHiltFHpqeIsVhWaosg1iqlgg4wAAEYEXsV3EmNppJmExMFYUxfVSuIs6E0sI5FkBBhLJzH9laQxLSjBj0WQJgSJPweDTkknvS4JGbCuxKOt7UY4lEQfNnAu9TzLxN2nUdAQTLAEw8YIlAVgAkmDCSBL75eCutSeY+GTUqqNkqUVxUbIl4qgJo4vWzecrhyQAMJldYf1MXLLl1EIsYBZgoGwpRI2zMTPtGBhYbSQAlJF9lieRzNMIriVBzPOWawvoIkYaNC0u9IcAIAHgp75NLQl8ENbPZJ6jgAU48RyFqHEuZyE+Pda/vjENAQBD5s209Y+kPJlyM4+r3lUS0AWSyVEhpHnjYu1pyO+7N4ywwPvhxHDiuwo8j1b5rkQwMZIziYHBXetPzIAAgIV8exZOSMoieI6aU5vKtgR0jqw1JtiYbZfW/R/kSN+mcWbxdtwYjn1XTd9B7cQAfNdCWB/OhBR7jvWv/3tWCAAoO3ktjyZZJ0HHbsq2AooERVQXzPKly2vOgPz29jNNBr+e1IcSz5YAM4hmFzPDtyWS+lDK4N2DfU+dbgsBAFHyd+oszE3agt/GjWcrUBEjj5sQBb96pXpXhAzueDJi4u1p41TsuQpCiFln4bkKeXMoJeadg++tG+sYAgBBXOo3RRrruAnfkWDmGfIdCeQhiiQgQbxjtlqzQk59vCZlNluL5lDiORLyMjcA4DsKeXM4AfDKxa97ThAAqPaMfaR1Nq6jOiqOAhOm5TsKJg1QZGGRedY7V6tzVcjBWk1D0JZ8cigt2RJSimkXnqOgW8MxQLUTb6wN5g0BgGPV0c9BekTH41xx5YXrQ8FkTRgdpxU7ea9djbYQ1GokmJ43wUhWtgRcS04tQjAcw9CWw29tThYOAXD03XVfMps/TTTOy30blDZgiqxFK6p7OsnvCDJ1UD9LyUjORoPDkUQyPfdHbXW+qJCjfRsOwOAoNY4z6Xz01rHq3k5zO4ZMHTabYSIhJD87MLB64f8Ys8WdG/tfBljMJedfwY+s/2P4Pv8AAAAASUVORK5CYII="}}]);
//# sourceMappingURL=sunny-map-view-14f90557c6395ac552bc.js.map