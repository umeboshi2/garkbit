(self.webpackJsonp=self.webpackJsonp||[]).push([[60,62],{192:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=g(n(1)),a=g(n(2)),i=g(n(3)),u=g(n(153));n(154);g(n(89));var l,c,s,f,d,p,h,y=g(n(97));function g(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}f=r.default.Radio.channel("global"),h=r.default.Radio.channel("messages"),l=r.default.Radio.channel("places"),c=function(){var e=function(e){function t(){return b(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,a.default.View),o(t,[{key:"className",value:function(){return"list-group-item location-item row"}},{key:"onLocationSelected",value:function(){return console.log("onLocationSelected")}}]),t}();return e.prototype.template=i.default.renderable(function(e){return i.default.span(".mr-auto",e.name),console.log("MODEL",e)}),e.prototype.tagName="li",e.prototype.triggers={click:"location:selected"},e}.call(void 0),s=function(){var e=function(e){function t(){return b(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,y.default),o(t,[{key:"ui",value:function(){return{itemList:".places-container",paginateBar:".paginate-bar"}}},{key:"regions",value:function(){return{itemList:"@ui.itemList",paginateBar:"@ui.paginateBar"}}}]),t}();return e.prototype.ItemView=c,e.prototype.template=i.default.renderable(function(){return i.default.div(".paginate-bar"),i.default.div(".places-container.list-group")}),e.prototype.childViewTriggers={"location:selected":"location:selected"},e}.call(void 0),p=function(){var e=function(e){function t(){return b(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,a.default.View),o(t,[{key:"mapOpdtions",value:function(){return{minZoom:14}}},{key:"onDomRefresh",value:function(){this.Map=u.default.map("map-view",this.getOption("mapOptions")),u.default.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png").addTo(this.Map),this.setLocation()}},{key:"setLocation",value:function(){var e,t,n;return 17,t=[(n=this.model.get("location")).latitude,n.longitude],this.Map.setView(t,17),(e=n.accuracy)>10&&(e=10),u.default.circle(t,e).addTo(this.Map)}},{key:"onModelChange",value:function(){var e;return console.log("model changed"),this.setLocation(),this.ui.title.text(this.model.get("name")),e="#places/view/"+this.model.get("id"),f.request("main:app:setLocationUrl",e)}}]),t}();return e.prototype.template=i.default.renderable(function(e){return i.default.div(".card",{style:"width: 18rem;"},function(){return i.default.div(".card-body",function(){return i.default.h5(".card-title",e.name),i.default.div("#map-view.card-text",{style:"height:20rem;"})})})}),e.prototype.ui={map:"#map-view",title:".card-title"},e.prototype.regions={workers:"@ui.workers",potentialWorkers:"@ui.potentialWorkers"},e.prototype.events={"click @ui.potentialBtn":"potentialBtnClicked"},e.prototype.modelEvents={change:"onModelChange"},e}.call(void 0),d=function(){var e=function(e){function t(){return b(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,a.default.View),o(t,[{key:"onRender",value:function(){var e,t,n,o=this;return n=new p({model:this.model}),this.showChildView("mapContainer",n),e=l.request("db:userlocation:collection"),(t=e.fetch()).fail(function(){return h.request("xhr-error",t)}),t.done(function(){return n=new s({collection:e}),o.showChildView("placesContainer",n)})}},{key:"onLocationSelected",value:function(e){var t,n,o=this;return t=e.model,(n=t.fetch()).fail(function(){return h.request("xhr-error",n)}),n.done(function(){return console.log("MODEL",t),o.model.set(t.toJSON())})}}]),t}();return e.prototype.template=i.default.renderable(function(e){return i.default.div(".map-container.col"),i.default.div(".places-container.col")}),e.prototype.className="row",e.prototype.ui={mapContainer:".map-container",placesContainer:".places-container"},e.prototype.regions={mapContainer:"@ui.mapContainer",placesContainer:"@ui.placesContainer"},e.prototype.childViewTriggers={"location:selected":"location:selected"},e}.call(void 0),t.default=d},193:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressView=t.ProgressModel=void 0;var o,r,a=l(n(1)),i=n(2),u=l(n(3));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.ProgressModel=o=function(){var e=function(e){function t(){return c(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,a.default.Model),t}();return e.prototype.defaults={valuemin:0,valuemax:100,valuenow:0},e}.call(void 0),t.ProgressView=r=function(){var e=function(e){function t(){return c(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,i.View),t}();return e.prototype.template=u.default.renderable(function(e){return u.default.div(".progress",function(){var t;return{valuemin:e.valuemin,valuemax:e.valuemax,valuenow:e.valuenow},t=Math.floor(e.valuenow/e.valuemax*100+.5),u.default.div(".progress-bar.progress-bar-striped",{role:"progressbar",style:"width: "+t+"%"},function(){return u.default.span({style:"color:black;"},e.valuenow+" of "+e.valuemax+".")})})}),e.prototype.modelEvents={change:"render"},e}.call(void 0),t.ProgressModel=o,t.ProgressView=r},275:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;return t={},a.default.forEach(function(n){var o;return o=e[n],t[n]=o}),t};var o,r=n(563),a=(o=r)&&o.__esModule?o:{default:o}},562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=d(n(1)),a=d(n(2)),i=d(n(3)),u=d(n(8)),l=d(n(275)),c=d(n(564)),s=d(n(192)),f=n(193);function d(e){return e&&e.__esModule?e:{default:e}}var p,h,y,g,b=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};h=r.default.Radio.channel("global"),g=r.default.Radio.channel("messages"),p=r.default.Radio.channel("places"),y=function(){var e=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.locationSuccess=e.locationSuccess.bind(e),e.locationError=e.locationError.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.View),o(t,[{key:"onRender",value:function(){var e,t,n=this;return this.collection.length<1&&g.request("warning","No locations found"),e=this.collection.at(0),(t=e.fetch()).fail(function(){return g.request("xhr-error",t)}),t.done(function(){var t;return t=new s.default({model:e}),n.showChildView("mainMapContainer",t)})}},{key:"locationBtnClicked",value:function(){var e;return e={success:this.locationSuccess,error:this.locationError},h.request("main:app:getCurrentPosition",e),this.ui.locationBtn.removeClass("btn-primary"),this.ui.locationBtn.addClass("btn-warning")}},{key:"locationSuccess",value:function(e){var n,o,r;return b(this,t),this.ui.locationBtn.hide(),this.ui.mainMapContainer.hide(),n=(0,l.default)(e.coords),o=new(p.request("db:userlocation:modelClass"))({coords:n,timestamp:e.timestamp}),r=new c.default({model:o}),this.showChildView("locationStatus",r)}},{key:"locationError",value:function(e){return b(this,t),console.log("locationError",e),g.request("warning",e.message),this.ui.locationBtn.removeClass("btn-warning"),this.ui.locationBtn.addClass("btn-primary"),this.showWaitProgress()}},{key:"showWaitProgress",value:function(){var e,t,n,o,r,a,i=this;return this.ui.locationBtn.hide(),o=new f.ProgressModel,r=new f.ProgressView({model:o}),this.showChildView("waitProgress",r),60,o.set("valuemax",60),o.set("valuenow",60),e=60,a=function(){return i.getRegion("waitProgress").empty(),i.ui.locationBtn.show()},t=function(){return o.set("valuenow",e),(e-=1)?setTimeout(n,(0,u.default)(".1s")):(console.log("finished on decrement",e),o.set("valuenow",e),a())},n=function(){return o.set("valuenow",e),(e-=1)?setTimeout(t,(0,u.default)(".1s")):(console.log("finished on decrement_2",e),o.set("valuenow",e),a())},t()}},{key:"onAddLocationCancelled",value:function(){return this.getRegion("locationStatus").empty(),this.ui.locationBtn.show(),this.ui.mainMapContainer.show()}}]),t}();return e.prototype.template=i.default.renderable(function(e){return i.default.div(".row.location-status","Current Location: Unknown"),i.default.div(".row",function(){return i.default.span(function(){return i.default.button(".get-location-btn.btn.btn-primary",function(){return i.default.text("Get Location")}),i.default.span(".wait-progress")})}),i.default.div(".row.main-map-container")}),e.prototype.ui={locationStatus:".location-status",locationBtn:".get-location-btn",mainMapContainer:".main-map-container",waitProgress:".wait-progress"},e.prototype.regions={locationStatus:"@ui.locationStatus",mainMapContainer:"@ui.mainMapContainer",waitProgress:"@ui.waitProgress"},e.prototype.events={"click @ui.locationBtn":"locationBtnClicked"},e.prototype.childViewEvents={"add:location:cancelled":"onAddLocationCancelled"},e}.call(void 0),t.default=y},563:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["latitude","longitude","altitude","accuracy","altitudeAccuracy","heading","speed"]},564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=c(n(1)),u=c(n(2)),l=c(n(3));c(n(275));function c(e){return e&&e.__esModule?e:{default:e}}o=i.default.Radio.channel("global"),i.default.Radio.channel("messages"),i.default.Radio.channel("places"),r=function(){var e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.View),a(t,[{key:"addLocationBtnClicked",value:function(){var e=this;return console.log("addLocationBtnClicked"),n.e(91).then(function(){var t;return t=new(0,n(614).default)({model:e.model}),o.request("main:app:show-modal",t)}.bind(null,n)).catch(n.oe)}},{key:"cancelBtnClicked",value:function(){return this.trigger("add:location:cancelled")}}]),t}();return e.prototype.template=l.default.renderable(function(e){var t;return t=e.coords,l.default.div(".card",function(){return l.default.div(".card-body",function(){return l.default.dt("Latitude"),l.default.dd(t.latitude),l.default.dt("Longitude"),l.default.dd(t.longitude)}),l.default.div(".card-footer",function(){return l.default.button(".cancel-btn.btn.btn-warning","Cancel"),l.default.button(".add-location-btn.btn.btn-primary","Add location")})})}),e.prototype.ui={status:".status",addLocationBtn:".add-location-btn",cancelBtn:".cancel-btn"},e.prototype.events={"click @ui.addLocationBtn":"addLocationBtnClicked","click @ui.cancelBtn":"cancelBtnClicked"},e}.call(void 0),t.default=r},89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=l(n(4)),a=l(n(1)),i=n(2),u=l(n(3));function l(e){return e&&e.__esModule?e:{default:e}}a.default.Radio.channel("global"),a.default.Radio.channel("messages"),t.default=function(){var e=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.keydownHandler=e.keydownHandler.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.View),o(t,[{key:"options",value:function(){return{setKeyHandler:!1,barLength:15,barStopAt:7}}},{key:"templateContext",value:function(){return{collection:this.collection,barLength:this.getOption("barLength"),barStopAt:this.getOption("barStopAt")}}},{key:"onDomRefresh",value:function(){return this.updateNavButtons()}},{key:"turnPage",value:function(e){var t;return e.preventDefault(),t=(0,r.default)(e.target).attr("data-pagenumber"),this.collection.getPage(Number(t)),this.updateNavButtons()}},{key:"updateNavButtons",value:function(){var e,t,n,o;return o=this.collection.state,n=this.ui.prevButton.parent(),o.currentPage===o.firstPage?n.hasClass("disabled")||n.addClass("disabled"):n.hasClass("disabled")&&n.removeClass("disabled"),t=this.ui.nextButton.parent(),o.currentPage===o.lastPage?t.hasClass("disabled")||t.addClass("disabled"):t.addClass("disabled")&&t.removeClass("disabled"),this.ui.numberedPage.parent().removeClass("active"),this.ui.numberedPage.removeClass("text-white"),this.ui.numberedPage.addClass("text-dark"),(e=(0,r.default)('[data-pagenumber="'+o.currentPage+'"]')).parent().addClass("active"),e.removeClass("text-dark"),e.addClass("text-white")}},{key:"getAnotherPage",value:function(e){var t,n,o,r;if(n=(r=this.collection.state).currentPage===r.lastPage,t=r.currentPage===r.firstPage,"prev"!==e||t){if("next"!==e||n){if(n)return;throw new Error("bad direction '"+e+"'")}o=this.collection.getNextPage()}else r.currentPage!==r.firstPage&&(o=this.collection.getPreviousPage());return this.updateNavButtons(),o}},{key:"getPreviousPage",value:function(){return this.getAnotherPage("prev")}},{key:"getNextPage",value:function(){return this.getAnotherPage("next")}},{key:"onRender",value:function(){if(this.getOption("setKeyHandler"))return this.onRenderHandleKeys()}},{key:"onBeforeDestroy",value:function(){if(this.getOption("setKeyHandler"))return this.onBeforeDestroyHandleKeys()}},{key:"handleKeyCommand",value:function(e){if("prev"===e||"next"===e)return this.getAnotherPage(e)}},{key:"keydownHandler",value:function(e){var n,o,r,a;for(n in function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")}(this,t),r=[],o=this.keycommands)a=o[n],e.keyCode===a?r.push(this.handleKeyCommand(n)):r.push(void 0);return r}},{key:"onRenderHandleKeys",value:function(){return(0,r.default)("html").keydown(this.keydownHandler)}},{key:"onBeforeDestroyHandleKeys",value:function(){return(0,r.default)("html").unbind("keydown",this.keydownHandler)}}]),t}();return e.prototype.tagName="ul",e.prototype.className="pagination",e.prototype.template=u.default.renderable(function(e){var t,n,o,r,i,l,c,s,f,d,p;for((d=e instanceof a.default.Collection?e.state:e.collection.state).totalPages,o=d.firstPage,t=!1,(i=d.lastPage)>e.barLength&&(t=!0,p=e.barStopAt,f=i-e.barStopAt),u.default.li(".page-item",function(){return u.default.a(".prev.page-link.bg-body-d5",function(){return u.default.i(".fa.fa-arrow-left")})}),n=!1,l=r=c=o,s=i;c<=s?r<=s:r>=s;l=c<=s?++r:--r)t&&l>=p&&l<=f?n||(n=!0,u.default.li(".page-item",function(){return u.default.a(".ellipsis-page.page-link.bg-body-d5.text-dark","...")})):u.default.li(".page-item",function(){return u.default.a(".numbered-page.page-link.bg-body-d5.text-dark",{href:"#",data:{pageNumber:l}},l)});return u.default.li(".page-item",function(){return u.default.a(".next.page-link.bg-body-d5",function(){return u.default.i(".fa.fa-arrow-right")})})}),e.prototype.ui={numberedPage:".numbered-page",prevButton:".prev",nextButton:".next"},e.prototype.events={"click @ui.numberedPage":"turnPage","click @ui.prevButton":"getPreviousPage","click @ui.nextButton":"getNextPage"},e.prototype.keycommands={prev:37,next:39},e}.call(void 0)},97:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=(l(n(1)),l(n(2))),i=l(n(98)),u=l(n(89));function l(e){return e&&e.__esModule?e:{default:e}}o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.View),r(t,[{key:"regions",value:function(){return{itemList:"@ui.itemList",paginateBar:"@ui.paginateBar"}}},{key:"onRender",value:function(){var e,t,n;if(e=this.getOption("collection"),console.log("collection",e),n=new i.default({collection:e,childView:this.getOption("ItemView"),childViewTriggers:this.getOption("childViewTriggers")}),this.showChildView("itemList",n),(null!=e&&null!=(t=e.state)?t.totalPages:void 0)>1)return n=new u.default({collection:e,setKeyHandler:!0}),this.showChildView("paginateBar",n)}}]),t}(),t.default=o},98:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a(n(1));var o,r=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}o=function(){var e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.CollectionView),t}();return e.prototype.tagName="ul",e.prototype.className="list-group",e}.call(void 0),t.default=o}}]);
//# sourceMappingURL=places-view-index-9ef8e1676f0301c264c7.js.map