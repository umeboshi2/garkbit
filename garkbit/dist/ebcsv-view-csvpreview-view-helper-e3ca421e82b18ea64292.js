(self.webpackJsonp=self.webpackJsonp||[]).push([[85],{376:function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u,a,l,s,f,d,p,v,h,b,y,m,w,_,g,k,x,O,j,q=[].indexOf;n(4),a=n(1),n(2),n(81),j=n(3),k=n(83),n(5);var C=n(30);C.make_field_input,C.make_field_select,n(30).form_group_input_div;var M=n(17);O=M.modal_close_button,v=a.Radio.channel("global"),h=a.Radio.channel("messages"),u=a.Radio.channel("ebcsv"),l=v.request("main:app:BaseModalView"),g=new a.Collection,u.reply("get-csvrow-collection",function(){return g}),x=function(){var e,t,n;for(t in n=[],e=u.request("get-csv-header"))n.push(e[t]);return""+n.join(",")},_=function(){var e,t,n,o,r,i,c,a,l,s;for(e=u.request("get-csvrow-collection"),u.request("get-csv-header"),c=[x()],o=0,r=(a=e.models).length;o<r;o++){for(n in s=[],t=a[o].toJSON())l=(l=t[n]).split('"').join('""'),q.call(l," ")>=0&&(l='"'+l+'"'),s.push(l);i=s.join(","),c.push(i)}return c.join("\r\n")+"\r\n"},b=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,l),t}();return e.prototype.template=j.renderable(function(e){return e.mainsection,j.div(".modal-dialog",function(){return j.div(".modal-content",function(){return j.h4("Title: "+e.Title),j.div(".modal-body",function(){return j.h4("Description:"),j.hr(),j.div(".panel",function(){return j.raw(e.Description)})}),j.div(".modal-footer",function(){return j.ul(".list-inline",function(){return"btn.btn-default.btn-sm",j.li("#close-modal",function(){return O("Close","check")})})})})})}),e}.call(void 0),y=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,l),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).csvheader=u.request("get-csv-header"),e}}]),t}();return e.prototype.template=j.renderable(function(e){return j.div(".modal-dialog",function(){return j.div(".modal-content",function(){return j.h3("Title: "+e.Title),j.div(".modal-body",function(){return j.h4("CSV Row:"),j.hr(),j.div(".panel",function(){return j.dl(".dl-horizontal",function(){return Object.keys(e).forEach(function(t){return j.dt(e.csvheader[t]),j.dd(e[t])})})})}),j.div(".modal-footer",function(){return j.ul(".list-inline",function(){return j.li("#close-modal",function(){return O("Close","check")})})})})})}),e}.call(void 0),w=["max-width:0","overflow:hidden","text-overflow:ellipsis","white-space:nowrap"].join(";")+";",p=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,a.Marionette.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).csvheader=u.request("get-csv-header"),e}},{key:"show_row",value:function(){var e;return e=new y({model:this.model}),v.request("show-modal",e)}},{key:"show_description",value:function(){var e;return e=new b({model:this.model}),v.request("show-modal",e)}}]),t}();return e.prototype.tagName="tr",e.prototype.template=j.renderable(function(e){return j.td(function(){return j.div(".btn-group.btn-group-justified",function(){return j.div(".show-desc-button.btn.btn-default.btn-xs",function(){return j.i(".fa.fa-eye")}),j.div(".show-row-button.btn.btn-default.btn-xs",function(){return j.i(".fa.fa-list")})})}),Object.keys(e.csvheader).forEach(function(t){return j.td({style:w},e[t])})}),e.prototype.ui={desc_btn:".show-desc-button",row_btn:".show-row-button"},e.prototype.events={"click @ui.desc_btn":"show_description","click @ui.row_btn":"show_row"},e}.call(void 0),d=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,a.Marionette.CollectionView),t}();return e.prototype.tagName="tbody",e.prototype.childView=p,e}.call(void 0),m=["table","table-striped","table-bordered","table-hover","table-condensed"],f=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,a.Marionette.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).ebcfg_collection=u.request("ebcfg-collection"),e.ebdsc_collection=u.request("ebdsc-collection"),e.csvheader=u.request("get-csv-header"),e}},{key:"onRender",value:function(){var e,t;return e=u.request("get-csvrow-collection"),t=new d({collection:e}),this.showChildView("body",t)}}]),t}();return e.prototype.tagName="table",e.prototype.className=m.join(" "),e.prototype.template=j.renderable(function(e){return j.div(".table-responsive",function(){return j.table("."+m.join("."),function(){return j.thead(function(){return j.tr(".info",function(){return j.td(function(){return j.i(".fa.fa-eye.fa-3x")}),Object.keys(e.csvheader).forEach(function(t){return j.th(e.csvheader[t])})})}),j.tbody()})})}),e.prototype.regions={body:{el:"tbody",replaceElement:!0}},e}.call(void 0),s=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,a.Marionette.View),o(t,[{key:"templateContext",value:function(){var e;return(e=this.options).ebcfg_collection=u.request("ebcfg-collection"),e.ebdsc_collection=u.request("ebdsc-collection"),e}},{key:"open_fileexchange_tab",value:function(){return window.open("http://bulksell.ebay.com/ws/eBayISAPI.dll?FileExchangeUploadForm","_blank")}},{key:"make_csv_file",value:function(){var e,t,n,o;return _(),t=new Date,"yyyy-mm-dd-HH:MM:ss",o=k(t,"yyyy-mm-dd-HH:MM:ss"),e=this.ui.filename_input.val()||"export-"+o+".csv",n={type:"data:text/csv;charset=utf-8",data:_(),el_id:"exported-csv-anchor",filename:e},v.request("export-to-file",n)}},{key:"createCsvRows",value:function(){var e,t,n,o,r,i,c,a,l;for(e=u.request("get-current-csv-action"),n=u.request("get-current-csv-cfg"),o=u.request("get-current-csv-dsc"),l=[],r=0,i=(a=this.collection.toJSON()).length;r<i;r++)c={action:e,comic:a[r],cfg:n,desc:o},t=u.request("create-csv-row-object",c),l.push(t);return u.request("get-csvrow-collection").set(l)}},{key:"onRender",value:function(){var e,t,n,o;return n=u.request("get-comic-image-urls"),Object.keys(n).length||(t="No pictures attached, please view comics, then create csv",h.request("warning",t)),this.createCsvRows(),e=u.request("get-csvrow-collection"),o=new f({collection:e}),this.showChildView("body",o)}}]),t}();return e.prototype.regions={body:".body"},e.prototype.template=j.renderable(function(e){var t,n;return n=new Date,"mmddHHMM",t="export-"+k(n,"mmddHHMM")+".csv",j.div(".listview-header",function(){return j.text("Preview CSV")}),j.div(".fileexchange-button.btn.btn-default","Ebay Upload"),j.div(".mkcsv-button.btn.btn-default","Create CSV"),j.input(".form-control",{value:t,name:"csvfilename"}),j.div(".body")}),e.prototype.ui={mkcsv_btn:".mkcsv-button",filename_input:"input[name='csvfilename']",fileexchange_btn:".fileexchange-button"},e.prototype.events={"click @ui.mkcsv_btn":"make_csv_file","click @ui.fileexchange_btn":"open_fileexchange_tab"},e}.call(void 0),e.exports=s}}]);
//# sourceMappingURL=ebcsv-view-csvpreview-view-helper-e3ca421e82b18ea64292.js.map